releases:
- name: bpm
  version: 1.1.6
  url: https://bosh.io/d/github.com/cloudfoundry/bpm-release?v=1.1.6
  sha1: 5bad6161dbbcf068830a100b6a76056fe3b99bc8
- name: capi
  version: 1.89.0
  url: https://bosh.io/d/github.com/cloudfoundry/capi-release?v=1.89.0
  sha1: 472966da017bda3118eb9cf71f9bcca1c23c344a
- name: cf-cli
  version: 1.23.0
  url: https://bosh.io/d/github.com/bosh-packages/cf-cli-release?v=1.23.0
  sha1: cda431fa1e550c28bf6f5c82b3a3cf2c168771f2
- name: cf-mysql
  version: 36.15.0
  url: https://bosh.io/d/github.com/cloudfoundry/cf-mysql-release?v=36.15.0
  sha1: 0764d9d6aae7cefd10019437ed83e7715e614633
- name: cf-smoke-tests
  version: 40.0.123
  url: https://bosh.io/d/github.com/cloudfoundry/cf-smoke-tests-release?v=40.0.123
  sha1: aeea22d0d7003d69b1d6154bae41360f821be420
- name: cf-syslog-drain
  version: 10.2.5
  url: https://bosh.io/d/github.com/cloudfoundry/cf-syslog-drain-release?v=10.2.5
  sha1: 6c4f683ac26a02c632726330572d3130e6f61704
- name: cflinuxfs3
  url: "https://bosh.io/d/github.com/cloudfoundry/cflinuxfs3-release?v=0.175.0"
  version: "0.175.0"
  sha1: "b185d04822db5ca20ac520149e415a59a1a1d83e"
- name: credhub
  version: 2.5.9
  url: https://bosh.io/d/github.com/pivotal-cf/credhub-release?v=2.5.9
  sha1: 225d508eed11c3f6f4a360118de068d5db9fa427
- name: diego
  version: 2.41.0
  url: https://bosh.io/d/github.com/cloudfoundry/diego-release?v=2.41.0
  sha1: 8a183683f26ba982eda1dbeba7f55edc9a1059b0
- name: garden-runc
  version: 1.19.9
  url: https://s3-us-west-2.amazonaws.com/suse-garden-runc-release/garden-runc-release-v1.19.9.tgz
  sha1: b1801e4ad91f4c176d9efe4166e1aee0cfd0c4ac
- name: loggregator
  version: 106.3.0
  url: https://bosh.io/d/github.com/cloudfoundry/loggregator-release?v=106.3.0
  sha1: f61a6ff8ca558899de8e992ba0271a06d7ae7c85
- name: log-cache
  version: 2.6.4
  url: https://bosh.io/d/github.com/cloudfoundry/log-cache-release?v=2.6.4
  sha1: 13a87a88128fb5231febce678cf9350d0979a116
- name: mapfs
  version: "1.1.0"
  url: "https://bosh.io/d/github.com/cloudfoundry/mapfs-release?v=1.1.0"
  sha1: "1ab1dfb802819ec6cda2d0d60370638d6f878528"
- name: nats
  version: '30'
  url: https://bosh.io/d/github.com/cloudfoundry/nats-release?v=30
  sha1: 77be62f17dbb50252039c2753def77b6808f8a5b
- name: nfs-volume
  version: "1.5.2"
  url: "https://bosh.io/d/github.com/cloudfoundry/nfs-volume-release?v=1.5.2"
  sha1: "14d019e6fd83139fab5e8ee7f162bf6920235888"
- name: pxc
  url: https://bosh.io/d/github.com/cloudfoundry-incubator/pxc-release?v=0.21.0
  version: 0.21.0
  sha1: 499e1bb3d90f9532229ff915f7704ac48b8a9741
- name: routing
  version: 0.196.0
  url: https://bosh.io/d/github.com/cloudfoundry/routing-release?v=0.196.0
  sha1: 5eab0c9c35b4f047ff83d0a266223edb357cb02d
- name: statsd-injector
  version: 1.11.8
  url: https://bosh.io/d/github.com/cloudfoundry/statsd-injector-release?v=1.11.8
  sha1: c70df26ca5c0d5a6c72243ad8b55476ee825a68f
- name: loggregator-agent
  version: 5.2.4
  url: https://bosh.io/d/github.com/cloudfoundry/loggregator-agent-release?v=5.2.4
  sha1: bc041f05b49bca8670df4ead2b471de4efee602a
- name: binary-buildpack
  url: "https://bosh.io/d/github.com/cloudfoundry/binary-buildpack-release?v=1.0.36"
  version: "1.0.36"
  sha1: "0269a613be68f988682bbf56504b78477965b1c4"
- name: suse-binary-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/binary-buildpack-release-1.0.36.1.tgz"
  version: "1.0.36.1"
  sha1: "fab68de90a2239338ce4d4188072a2c6152acc4c"
- name: suse-go-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/go-buildpack-release-1.9.11.1.tgz"
  version: "1.9.11.1"
  sha1: "651b3668cb621ee82771dcd81ee14adc2b42631c"
- name: "go-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/go-buildpack-release?v=1.9.7"
  version: "1.9.7"
  sha1: "3fbd1a0411ae1520c9166f3c0df2baa7b093f112"
- name: suse-java-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/java-buildpack-release-4.28.0.1.tgz"
  version: "4.28.0.1"
  sha1: "7e453c15741e2e7e6f8846501d37005e56692b1d"
- name: suse-nodejs-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/nodejs-buildpack-release-1.7.17.1.tgz"
  version: "1.7.17.1"
  sha1: "f69bfa7a08389fddcfdc7698ae0355f22391a5b9"
- name: "nodejs-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/nodejs-buildpack-release?v=1.7.13"
  version: "1.7.13"
  sha1: "f6bf4499abbc5180d5ead246d2e2fa0607befd57"
- name: suse-php-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/php-buildpack-release-4.4.2.1.tgz"
  version: "4.4.2.1"
  sha1: "0468d080a7069b0e9ccaeac23d89caa42922a50b"
- name: "php-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/php-buildpack-release?v=4.4.8"
  version: "4.4.8"
  sha1: "7818cf2f5d11164bb600a7077a808385a06294de"
- name: suse-python-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/python-buildpack-release-1.7.5.1.tgz"
  version: "1.7.5.1"
  sha1: "5e3be06915ecae4e975dea9bfbd34e31b4e50f56"
- name: "python-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/python-buildpack-release?v=1.7.8"
  version: "1.7.8"
  sha1: "27667ee2486e2baa3e7ef9a6d8963a6841d19204"
- name: suse-ruby-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/ruby-buildpack-release-1.8.3.1.tgz"
  version: "1.8.3.1"
  sha1: "ae62f8120a9ab2324ccb3ca2da3f44402986d569"
- name: "java-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/java-buildpack-release?v=4.26"
  version: "4.26"
  sha1: "24e8c51cbf364fc38f40d0e261dd3bb663e145e3"
- name: "ruby-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/ruby-buildpack-release?v=1.8.10"
  version: "1.8.10"
  sha1: "5ddfd09cb2deba3a7c050c8dac7f02c86cac2bd7"
- name: suse-staticfile-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/staticfile-buildpack-release-1.5.5.1.tgz"
  version: "1.5.5.1"
  sha1: "f1b64df5de8d2c9689ebde52bf8f5e8b2a18d06b"
- name: "staticfile-buildpack"
  url: "https://bosh.io/d/github.com/cloudfoundry/staticfile-buildpack-release?v=1.5.4"
  version: "1.5.4"
  sha1: "04e887342a28d58bb8ba927af381d9d4d9c70ae2"
- name: suse-nginx-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/nginx-buildpack-release-1.1.3.1.tgz"
  version: "1.1.3.1"
  sha1: "40819df1f89765f7bc73eca7309b9b5fbd5d0e64"
- name: nginx-buildpack
  url: "https://bosh.io/d/github.com/cloudfoundry/nginx-buildpack-release?v=1.1.5"
  version: "1.1.5"
  sha1: "37f34ecd9a1e120f4479990e31e87c8da85f7fdb"
- name: suse-dotnet-core-buildpack
  url: "https://s3.amazonaws.com/suse-final-releases/dotnet-core-buildpack-release-2.3.9.1.tgz"
  version: "2.3.9.1"
  sha1: "f47c3cfd3660aea70ee0700381780c23e2a37888"
- name: dotnet-core-buildpack
  url: "https://bosh.io/d/github.com/cloudfoundry/dotnet-core-buildpack-release?v=2.3.6"
  version: "2.3.6"
  sha1: "7f2b3c932b60fbe696abffc138aa28069b69059a"
- name: postgres
  version: "26"
  url: "https://bosh.io/d/github.com/cloudfoundry/postgres-release?v=26"
  sha1: "a436047dae4d4156a1debe9f88bedf59bf40362b"
- name: cf-sle12
  url: "https://s3.amazonaws.com/suse-final-releases/sle12-release-1.81.87.tgz"
  version: "1.81.87"
  sha1: "84e71be2c0dbd883c32963769a2c734191ee25e8"
- name: sle15
  url: "https://s3.amazonaws.com/suse-final-releases/sle15-release-24.30.tgz"
  version: "24.30"
  sha1: "ff040738223299d08b8ff2aeed397a3378329d9f"
- name: cf-usb
  version: "1.0.1"
  url: "https://s3.amazonaws.com/suse-final-releases/cf-usb-release-1.0.1.tgz"
  sha1: "3dc34e90b55d9d61f93f204fce11655b7cd87c87"
- name: groot-btrfs
  url: "https://s3.amazonaws.com/suse-final-releases/groot-btrfs-release-1.0.5.tgz"
  version: "1.0.5"
  sha1: "eed1eed8d1b2bb20968c4a028d67fb095b606ae8"
- name: scf-helper
  url: "https://s3.amazonaws.com/suse-final-releases/scf-helper-release-1.0.13.tgz"
  version: "1.0.13"
  sha1: "006204023d9f37fc61f2d696e777fad42ea73fea"
- name: "bits-service"
  version: "2.28.0"
  url: "https://bosh.io/d/github.com/cloudfoundry-incubator/bits-service-release?v=2.28.0"
  sha1: "bd173fc9952277ea962a330c04555d9bd1e8a10e"
- name: "eirini"
  url: "https://s3.amazonaws.com/suse-final-releases/eirini-release-0.0.26.tgz"
  version: "0.0.26"
  sha1: "72822748ffabd3094359b9f5f9d607cc189b28ba"
- name: "eirinifs-sle15-release"
  url: "https://s3.amazonaws.com/suse-final-releases/eirinifs-sle15-release-0.1.2.tgz"
  version: "0.1.2"
  sha1: "42bd833ae7c755be18a6825eee922f5de5aafaab"
- name: uaa
  version: 74.12.0
  url: https://bosh.io/d/github.com/cloudfoundry/uaa-release?v=74.12.0
  sha1: 5fdd99addec2aebe521a468dba0bcd52e66c86c6

instance_groups:
- name: configgin-helper
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: configgin-helper
    release: scf-helper
    properties:
      bosh_containerization:
        run:
          service-account: configgin
          scaling:
            min: 1
            max: 65535
            ha: 2
          memory: 64
          virtual-cpus: 1
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - configgin-helper
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
- name: eirini
  if_feature: eirini
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  # eirini-bosh-release already includes kubectl package, so we don't need get-kubectl job from scf-release.
  - scripts/set-opi-registry-port.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: patch-properties
    release: scf-helper
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          capabilities: [ALL]
          privileged: true
  - name: eirini-loggregator-bridge
    release: eirini
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
  - name: opi
    release: eirini
    properties:
      bosh_containerization:
        run:
          service-account: eirini
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
        ports:
        - name: opi-server
          protocol: TCP
          internal: 8484
- name: eirini-persi
  if_feature: eirini
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: patch-properties
    release: scf-helper
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          capabilities: [ALL]
          privileged: true
  - name: eirini-persi-broker
    release: eirini
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
        ports:
        - name: broker
          protocol: TCP
          internal: 8999
  - name: eirini-persi
    release: eirini
    properties:
      bosh_containerization:
        run:
          service-account: eirini
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
        ports:
        - name: webhook
          protocol: TCP
          external: 443
          internal: 8443
- name: eirini-ssh
  if_feature: eirini
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/uaa_ca_cert_eirini_ssh_proxy.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: patch-properties
    release: scf-helper
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          capabilities: [ALL]
          privileged: true
  - name: eirini-ssh-proxy
    release: eirini
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
        ports:
        - name: eirini-ssh
          protocol: TCP
          internal: 2222
          public: true
  - name: eirini-ssh-extension
    release: eirini
    properties:
      bosh_containerization:
        run:
          service-account: eirini
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
        ports:
        - name: webhook
          protocol: TCP
          external: 443
          internal: 8443
- name: bits
  if_feature: eirini
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: statsd_injector
    release: statsd-injector
  - name: eirinifs-sle15
    release: eirinifs-sle15-release
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: bits-service
    release: bits-service
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
            ha: 1
          memory: 256
          virtual-cpus: 2
  configuration:
    templates:
      properties.bits-service.registry_endpoint: "https://127.0.0.1"
      properties.bpm.enabled: true
- name: syslog-scheduler
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: scheduler
    release: cf-syslog-drain
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 128
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - syslog-scheduler
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://localhost:8080/health
        ports:
        - name: sched-health
          protocol: TCP
          internal: 8080
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: adapter
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: adapter
    release: cf-syslog-drain
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling: # one per 500 drains
            min: 1
            max: 65535
            ha: 2
          memory: 128
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - adapter
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://localhost:8080/health
        ports:
        - name: adapter
          protocol: TCP
          internal: 4443
        - name: adapter-health
          protocol: TCP
          internal: 8080
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: nats
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: nats
    release: nats
    provides:
      nats: {}
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - nats
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: nats
          protocol: TCP
          internal: 4222
        - name: nats-routes
          protocol: TCP
          internal: 4223
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.nats.machines: ((KUBE_NATS_CLUSTER_IPS))((#KUBE_SIZING_NATS_COUNT))((/KUBE_SIZING_NATS_COUNT))
- name: mysql
  default_feature: mysql
  scripts:
  - scripts/create_mysql_data_tmp.sh # Deprecated. Should go away with cf-mysql-release.
  - scripts/chown_vcap_store.sh
  - scripts/pxc/create_directories.sh
  - scripts/patches/fix_mysql_advertise_ip.sh # Deprecated. Should go away with cf-mysql-release.
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: patch-properties
    release: scf-helper
  - name: pxc-mysql
    release: pxc
    provides:
      mysql: {}
    properties:
      bosh_containerization:
        ports:
        - name: pxc-mysql
          protocol: TCP
          internal: 3306
        - name: galera-tcp
          protocol: TCP
          internal: 4567
        - name: galera-agent
          protocol: TCP
          internal: 9200
        run:
          scaling:
            min: 1
            max: 7
            ha: 3
            # To avoid split-brain.
            must_be_odd: true
          capabilities: [AUDIT_WRITE]
          volumes:
          - path: /var/vcap/store
            type: persistent
            tag: mysql-data
            size: 20
          memory: 2500
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - "[[ $(curl --silent http://${HOSTNAME}:9200/api/v1/status | jq '.healthy') == true ]]"
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - mysql
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
  - name: galera-agent
    release: pxc
  - name: gra-log-purger
    release: pxc
  - name: cluster-health-logger
    release: pxc
  - name: bootstrap
    release: pxc
  - name: mysql
    release: cf-mysql
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  tags:
  - sequential-startup
  configuration:
    templates:
      properties.admin_password: ((MYSQL_ADMIN_PASSWORD))

      # Deprecation start. Should go away with cf-mysql-release. >>
      properties.cf_mysql.mysql.admin_password: ((MYSQL_ADMIN_PASSWORD))
      properties.cf_mysql.mysql.cluster_health.password: ((MYSQL_CLUSTER_HEALTH_PASSWORD))
      properties.cf_mysql.mysql.galera_healthcheck.db_password: ((MYSQL_ADMIN_PASSWORD))
      properties.cf_mysql.mysql.galera_healthcheck.endpoint_password: ((MYSQL_GALERA_HEALTHCHECK_ENDPOINT_PASSWORD))
      # << Deprecation end

      properties.db_password: ((MYSQL_ADMIN_PASSWORD))
      properties.endpoint_password: ((MYSQL_GALERA_HEALTHCHECK_ENDPOINT_PASSWORD))
      properties.engine_config.galera.enabled: true
      properties.monit_startup_timeout: 300
      properties.seeded_databases: &seeded_databases >
        [
          {"name":"ccdb","username":"ccadmin","password":"((MYSQL_CCDB_ROLE_PASSWORD))"},
          {"name":"diego","username":"diego","password":"((MYSQL_DIEGO_PASSWORD))"},
          {"name":"routing-api","username":"routing-api","password":"((MYSQL_ROUTING_API_PASSWORD))"},
          {"name":"usb","username":"usb","password":"((MYSQL_CF_USB_PASSWORD))"},
          {"name":"nfsvolume","username":"nfsvolume","password":"((MYSQL_PERSI_NFS_PASSWORD))"},
          {"name":"diego_locket","username":"diego_locket","password":"((MYSQL_DIEGO_LOCKET_PASSWORD))"},
          {"name":"credhub_user","username":"credhub_user","password":"((MYSQL_CREDHUB_USER_PASSWORD))"},
          {"name":"uaadb", "username": "uaaadmin", "password":"((UAADB_PASSWORD))"}
        ]
      properties.tls.galera.ca: ((INTERNAL_CA_CERT))
      properties.tls.galera.certificate: ((GALERA_SERVER_CERT))
      properties.tls.galera.private_key: ((GALERA_SERVER_CERT_KEY))
      properties.tls.server.ca: ((INTERNAL_CA_CERT))
      properties.tls.server.certificate: ((MYSQL_SERVER_CERT))
      properties.tls.server.private_key: ((MYSQL_SERVER_CERT_KEY))
- name: mysql-proxy
  default_feature: mysql
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: switchboard-leader
    release: scf-helper
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: proxy
    release: pxc
    provides:
      proxy: {}
    properties:
      bosh_containerization:
        ports:
        - name: api-proxy
          protocol: TCP
          internal: 8083
        - name: pxc-mysql-proxy
          protocol: TCP
          internal: 3306
        - name: healthck-proxy
          protocol: TCP
          internal: 1936
        run:
          service-account: active-passive
          scaling:
            min: 1
            max: 5
            ha: 2
          capabilities: [AUDIT_WRITE]
          memory: 2500
          virtual-cpus: 2
          active-passive-probe: /var/vcap/jobs/switchboard-leader/bin/readiness/switchboard
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:1936/
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - mysql-proxy
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
  tags:
  - active-passive
  - sequential-startup
  configuration:
    templates:
      properties.api_force_https: false
      properties.api_password: ((MYSQL_PROXY_ADMIN_PASSWORD))
      properties.api_port: 8083
      properties.api_uri: mysql-proxy-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.api_username: mysql_proxy
- name: cf-usb-group
  default_feature: cf_usb
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: cf-usb
    release: cf-usb
    properties:
      bosh_containerization:
        service_name: cf-usb
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 128
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - cf-usb-group
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: usb
          protocol: TCP
          internal: 24054
        - name: usb2
          protocol: TCP
          internal: 24053
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  tags:
  - sequential-startup
  configuration:
    templates:
      properties.route_registrar.routes: '[{"name":"usb", "port": 24053, "uris":["usb.((DOMAIN))", "*.usb.((DOMAIN))"], "registration_interval":"10s"}, {"name":"broker", "port": 24054, "uris":["brokers.((DOMAIN))", "*.brokers.((DOMAIN))"], "registration_interval":"10s"}]'
- name: diego-api
  unless_feature: eirini
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: bbs
    release: diego
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          service-account: active-passive
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 2
          active-passive-probe: /var/vcap/jobs/global-properties/bin/readiness/diego-api
          healthcheck:
            readiness:
              command:
              # See BOSH property diego.bbs.health_addr
              - curl --fail http://$(jq -r .health_address /var/vcap/jobs/bbs/config/bbs.json)/ping
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - diego-api
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: cell-bbs-api
          protocol: TCP
          internal: 8889
        - name: cell-bbs-dbg
          protocol: TCP
          internal: 17017
  - name: patch-properties
    release: scf-helper
  - name: cfdot
    release: diego
  tags:
  - active-passive
  - sequential-startup
  configuration:
    templates:
      properties.bbs.hostname: '"diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"' # cfdot property
      properties.diego.bbs.advertisement_base_hostname: ((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.locket.hostname: '"locket-locket.((KUBERNETES_NAMESPACE))"'    # cfdot property
      properties.tls.ca_certificate: ((INTERNAL_CA_CERT))                   # cfdot property
      properties.tls.certificate: '"((BBS_REP_CERT))"'                      # cfdot property
      properties.tls.private_key: '"((BBS_REP_CERT_KEY))"'                  # cfdot property
- name: locket
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: patch-properties
    release: scf-helper
  - name: locket
    release: diego
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - head -c0 </dev/tcp/${HOSTNAME}/8891
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - locket
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: locket
          protocol: TCP
          internal: 8891
- name: router
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: gorouter
    release: routing
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 65535
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 4
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:8080/health
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - diego-cell
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - router
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: router
          protocol: TCP
          external: 80
          internal: 8000
          public: true
        - name: router-ssl
          protocol: TCP
          internal: 443
          public: true
- name: tcp-router
  # XXX haproxy might be able to co-locate with one of the others
  # But this is a _different_ HAProxy from the one in the CF release.
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/patches/fix_haproxy_fd_requirements.sh
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: wait-for-uaa
    release: scf
  - name: tcp_router
    release: routing
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 128
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:8080/health
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - tcp-router
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: healthcheck
          protocol: TCP
          external: 2341
          internal: 8080
        - name: tcp-route
          protocol: TCP
          internal: 20000-20008
          public: true
          count-configurable: true
          max: 20
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.dns_health_check_host: 'nats-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)).'
- name: routing-api
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: routing-api
    release: routing
    provides:
      routing_api: {}
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          service-account: active-passive
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 4
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - routing-api
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
          # All the routes exposed require UAA auth, so we stick with the TCP healthcheck
          active-passive-probe: head -c0 </dev/tcp/${HOSTNAME}/3000
        ports:
        - name: routing-api
          protocol: TCP
          internal: 3000
  tags:
  - active-passive
  - sequential-startup
  configuration:
    templates:
      properties.dns_health_check_host: 'nats-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)).'
- name: api-group
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/nginx_log_level.sh
  - scripts/override-default-stack.sh
  scripts:
  - scripts/patches/fix_blobstore_send_timeout.sh
  - scripts/patches/fix_nodejs_buildpack.sh
  - scripts/patches/fix_logcache_ca_cert.sh
  - scripts/forward_logfiles.sh
  - scripts/patches/use_routing_api_private_endpoint.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/cc_pre_start_home.sh
  - scripts/patches/cc_ng_disable_credhub.sh
  - scripts/patches/cc_migration_squash.sh
  - scripts/patches/uaa_ca_cert_cc_ng.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: patch-properties
    release: scf-helper
  - name: wait-for-database
    release: scf-helper
  - name: cloud_controller_ng
    release: capi
    consumes:
      log-cache: {ignore: true}
      file_server: {ignore: true}
      credhub: {ignore: true}
    properties:
      bosh_containerization:
        # XXX Maintain old service name for backwards compatiblities so apps keep running
        service_name: api
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 65535
            ha: 2
          memory: 3800
          virtual-cpus: 4
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:9022/v2/info
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - api-group
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: api
          protocol: TCP
          internal: 9022
        - name: api-tls
          protocol: TCP
          internal: 9023
        - name: api-mutual-tls
          protocol: TCP
          internal: 9024
        - name: statsd
          protocol: TCP
          internal: 8125
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: statsd_injector
    release: statsd-injector
  - name: suse-go-buildpack
    release: suse-go-buildpack
  - name: go-buildpack
    release: go-buildpack
  - name: suse-binary-buildpack
    release: suse-binary-buildpack
  - name: binary-buildpack
    release: binary-buildpack
  - name: suse-nodejs-buildpack
    release: suse-nodejs-buildpack
  - name: nodejs-buildpack
    release: nodejs-buildpack
  - name: suse-ruby-buildpack
    release: suse-ruby-buildpack
  - name: ruby-buildpack
    release: ruby-buildpack
  - name: suse-php-buildpack
    release: suse-php-buildpack
  - name: php-buildpack
    release: php-buildpack
  - name: suse-python-buildpack
    release: suse-python-buildpack
  - name: python-buildpack
    release: python-buildpack
  - name: suse-staticfile-buildpack
    release: suse-staticfile-buildpack
  - name: staticfile-buildpack
    release: staticfile-buildpack
  - name: suse-nginx-buildpack
    release: suse-nginx-buildpack
  - name: nginx-buildpack
    release: nginx-buildpack
  - name: suse-java-buildpack
    release: suse-java-buildpack
  - name: java-buildpack
    release: java-buildpack
  - name: suse-dotnet-core-buildpack
    release: suse-dotnet-core-buildpack
  - name: dotnet-core-buildpack
    release: dotnet-core-buildpack
  tags:
  - sequential-startup
  configuration:
    templates:
      properties.cc.logcache.host: doppler-log-cache.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.cc.logcache_tls.certificate: '"((LOG_CACHE_CERT))"'
      properties.cc.logcache_tls.private_key: '"((LOG_CACHE_CERT_KEY))"'
      properties.cc.logcache_tls.subject_name: "log-cache"
      properties.cc.temporary_use_logcache: true
      properties.route_registrar.routes: '[{"name": "api", "port": 9022, "tls_port": 9024, "server_cert_domain_san": "api-set", "tags": {"component": "CloudController"}, "uris": ["api.((DOMAIN))"], "registration_interval": "10s"}]'
      properties.wait-for-database.hostname: &cf-internal-database-host >
        ((#DB_EXTERNAL_HOST))
          ((DB_EXTERNAL_HOST))
        ((/DB_EXTERNAL_HOST))
        ((^DB_EXTERNAL_HOST))
          mysql-proxy-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
        ((/DB_EXTERNAL_HOST))
      properties.wait-for-database.port: &cf-internal-database-port >
        ((#DB_EXTERNAL_HOST))((DB_EXTERNAL_PORT))((/DB_EXTERNAL_HOST))((^DB_EXTERNAL_HOST))3306((/DB_EXTERNAL_HOST))
- name: cc-worker
  environment_scripts:
  - scripts/override-default-stack.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/cc_worker_disable_credhub.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/cc_migration_squash.sh
  - scripts/patches/uaa_ca_cert_cc_worker.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: cloud_controller_worker
    release: capi
    consumes:
      file_server: {ignore: true}
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 65535
            ha: 2
          memory: 750
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - cc-worker
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: blobstore
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  scripts:
  - scripts/chown_vcap_store.sh
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_chown_blobstore_packages.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: blobstore
    release: capi
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 1
            # Not HA capable; use external HA storage instead
          volumes:
          - path: /var/vcap/store
            type: persistent
            tag: blobstore-data
            size: 50
          memory: 500
          virtual-cpus: 2
        ports:
        - name: blobstore-ext
          protocol: TCP
          internal: 8080
        - name: blobstore
          protocol: TCP
          internal: 4443
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.route_registrar.routes: '[{"name":"blobstore", "port":8080, "tags":{"component":"blobstore"}, "uris":["blobstore.((DOMAIN))"], "registration_interval":"10s"}]'
- name: cc-clock
  environment_scripts:
  - scripts/override-default-stack.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/cc_clock_disable_credhub.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/cc_migration_squash.sh
  - scripts/patches/uaa_ca_cert_cc_clock.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca
    release: scf
  - name: wait-for-api
    release: scf
    # This job contains a pre-start script whose prupose is to delay
    # pod startup until the API role is up, and thus has run and
    # completed the CC database migrations. If the clock role and job
    # become active while the API role is still doing migrations, or
    # has not even started them yet then the two roles can get into a
    # conflict wrt database access and state which blocks the entire
    # system from coming up.
  - name: cloud_controller_clock
    release: capi
    consumes:
      file_server: {ignore: true}
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 750
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - cc-clock
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
  - name: statsd_injector
    release: statsd-injector
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: doppler
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  # Don't use bosh link to get the RLP address and port
  - scripts/patches/set_logs_provider_addr.sh
  - scripts/patches/uaa_ca_cert_log_cache_cf_auth_proxy.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: log-cache-gateway
    release: log-cache
    # gateway_addr - default - ":8081"
  - name: log-cache-nozzle
    release: log-cache
    consumes:
      reverse_log_proxy: {ignore: true}
    # mostly default, logs_provider cert, see below
  - name: log-cache-cf-auth-proxy
    release: log-cache
    # defaults
  - name: log-cache
    release: log-cache
    # certs, see below
    provides:
      log-cache: {}
    properties:
      bosh_containerization:
        ports:
        - name: log-cache
          protocol: TCP
          internal: 8080
  - name: doppler
    release: loggregator
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 65535
            ha: 2
          memory: 410
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - head -c0 </dev/tcp/${HOSTNAME}/8082
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - doppler
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: dropsonde-udp
          protocol: UDP
          internal: 3457
        - name: dropsonde-tcp
          protocol: TCP
          internal: 3458
        - name: doppler-tls
          protocol: TCP
          internal: 3459
        - name: doppler-ws
          protocol: TCP
          internal: 8081
        - name: doppler-grpc
          protocol: TCP
          internal: 8082
        - name: log-cache-proxy # log-cache-cf-auth-proxy
          protocol: TCP
          internal: 8083
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  configuration:
    templates:
      properties.cc.ca_cert: '"((INTERNAL_CA_CERT))"'
      properties.cc.common_name: api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.logs_provider.tls.ca_cert: '"((INTERNAL_CA_CERT))"'
      properties.logs_provider.tls.cert: '"((LOG_CACHE_CERT))"'
      properties.logs_provider.tls.key: '"((LOG_CACHE_CERT_KEY))"'
      properties.proxy_ca_cert: '"((INTERNAL_CA_CERT))"'
      properties.proxy_cert: '"((LOG_CACHE_GATEWAY_PROXY_CERT))"'
      properties.proxy_key: '"((LOG_CACHE_GATEWAY_PROXY_CERT_KEY))"'
      properties.proxy_port: 8083 # log-cache-cf-auth-proxy
      properties.route_registrar.routes: >
        [{ "name": "log-cache-reverse-proxy",
           "tls_port": 8083,
           "server_cert_domain_san": "log-cache",
           "tags": { "component":"log-cache" },
           "uris": ["log-cache.((DOMAIN))", "*.log-cache.((DOMAIN))"],
           "registration_interval": "20s" }
        ]
      properties.tls.ca_cert: '"((INTERNAL_CA_CERT))"'
      properties.tls.cert: '"((LOG_CACHE_CERT))"'
      properties.tls.key: '"((LOG_CACHE_CERT_KEY))"'
      properties.uaa.ca_cert: '"((UAA_CA_CERT))"'
      properties.uaa.client_id: 'doppler'
      properties.uaa.client_secret: '"((UAA_CLIENTS_DOPPLER_SECRET))"'
      properties.uaa.internal_addr: '"https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))"'
- name: log-api
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/uaa_ca_cert_loggregator_trafficcontroller.sh
  - scripts/patches/uaa_ca_cert_reverse_log_proxy_gateway.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: loggregator_trafficcontroller
    release: loggregator
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 65535
            ha: 2
          memory: 128
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head --insecure https://${HOSTNAME}:8081/set-cookie
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - log-api
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: dropsonde
          protocol: TCP
          internal: 8081
  - name: reverse_log_proxy
    release: loggregator
    provides:
      reverse_log_proxy: {}
    properties:
      bosh_containerization:
        ports:
        - name: rlp
          protocol: TCP
          internal: 8082
  - name: reverse_log_proxy_gateway
    release: loggregator
    properties:
      bosh_containerization:
        ports:
        - name: rlp-gateway
          protocol: TCP
          internal: 8088
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.cc.ca_cert:                    ((INTERNAL_CA_CERT))
      properties.cc.cert:                       ((RLP_GATEWAY_CERT))
      properties.cc.common_name: api-group.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.cc.key:                        ((RLP_GATEWAY_CERT_KEY))
      properties.http.cert:                     ((RLP_GATEWAY_CERT))
      properties.http.key:                      ((RLP_GATEWAY_CERT_KEY))
      properties.logs_provider.ca_cert:         ((INTERNAL_CA_CERT))
      properties.logs_provider.client_cert:     ((SYSLOG_RLP_CERT))
      properties.logs_provider.client_key:      ((SYSLOG_RLP_CERT_KEY))
      properties.route_registrar.routes: >
        [{ "name": "doppler",
           "tls_port": 8081,
           "registration_interval": "20s",
           "server_cert_domain_san": "doppler",
           "uris": ["doppler.((DOMAIN))", "*.doppler.((DOMAIN))"] },
         { "name": "rlp-gateway",
           "tls_port": 8088,
           "registration_interval": "20s",
           "server_cert_domain_san": "log-stream",
           "uris": ["log-stream.((DOMAIN))", "*.log-stream.((DOMAIN))"] }]
      properties.uaa.ca_cert: '"((UAA_CA_CERT))"'
      properties.uaa.client_id: 'doppler'
      properties.uaa.client_secret: '"((UAA_CLIENTS_DOPPLER_SECRET))"'
      properties.uaa.internal_addr: '"https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))"'
- name: diego-brain
  unless_feature: eirini
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: auctioneer
    release: diego
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          service-account: active-passive
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 4
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - diego-brain
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
          # Auctioneer has no useful healthcheck routes; we can only use the TCP port
          active-passive-probe: head -c0 </dev/tcp/${HOSTNAME}/9016
        ports:
        - name: diego-auction
          protocol: TCP
          internal: 9016
  - name: patch-properties
    release: scf-helper
  - name: cfdot
    release: diego
  tags:
  - active-passive
  configuration:
    templates:
      properties.bbs.hostname: '"diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"' # cfdot property
      properties.locket.hostname: '"locket-locket.((KUBERNETES_NAMESPACE))"'    # cfdot property
      properties.tls.ca_certificate: ((INTERNAL_CA_CERT))                   # cfdot property
      properties.tls.certificate: '"((BBS_REP_CERT))"'                      # cfdot property
      properties.tls.private_key: '"((BBS_REP_CERT_KEY))"'                  # cfdot property
- name: cc-uploader
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: tps
    release: capi
  - name: cc_uploader
    release: capi
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 4
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - cc-uploader
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: cc-up-listen
          protocol: TCP
          internal: 9091
        - name: cc-up-dbg
          protocol: TCP
          internal: 17018
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: diego-ssh
  unless_feature: eirini
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/uaa_ca_cert_ssh_proxy.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: ssh_proxy
    release: diego
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          capabilities: [AUDIT_WRITE, SYS_RESOURCE]
          memory: 128
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:8080/v1/static/file_server/bin/file-server
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - diego-ssh
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: diego-ssh
          protocol: TCP
          internal: 2222
          public: true
  - name: file_server
    release: diego
    provides:
      file_server: {}
    properties:
      bosh_containerization:
        # XXX Maintain old service name so DesiredLRPs remain valid after upgrades
        service_name: diego-access
        ports:
        - name: diego-files
          protocol: TCP
          internal: 8443
  configuration:
    templates:
      properties.https_server_enabled: true
      properties.https_url: https://diego-access.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8443
      properties.tls.cert: '"((FILE_SERVER_CERT))"'
      properties.tls.key: '"((FILE_SERVER_CERT_KEY))"'
- name: nfs-broker
  unless_feature: eirini
  environment_scripts:
  - scripts/go_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/nfsbroker_cert_prop.sh
  - scripts/patches/nfsbroker_ctl.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: nfsbroker
    release: nfs-volume
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          privileged: true
          memory: 128
          virtual-cpus: 2
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - nfs-broker
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: nfsbroker
          protocol: TCP
          internal: 8999
  tags:
  - sequential-startup
  configuration:
    templates:
      properties.nfsbroker.credhub.ca_cert: '~'
      properties.nfsbroker.credhub.uaa_ca_cert: '~'
      properties.nfsbroker.db_ca_cert: '~'
- name: diego-cell
  unless_feature: eirini
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/set-diego-cell-memory-limits.sh
  - scripts/go_log_level.sh
  - scripts/configure-garden-filesystem.sh
  - scripts/configure-az.sh
  - scripts/configure-pz.sh
  scripts:
  - scripts/check_swapaccounting.sh
  - scripts/configure-nested-net.sh
  - scripts/cleanup-garden-graph.sh
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/mapfs_pre_start.sh
  - scripts/patches/nfs-volume-nfsv3driver-libdir.sh
  - scripts/patches/fix_garden_logdir.sh
  - scripts/patches/uaa_ca_cert_route_emitter.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: get-kubectl
    release: scf
  - name: wait-for-uaa
    release: scf
  - name: rep
    release: diego
    properties:
      bosh_containerization:
        ports:
        - name: rep-server
          protocol: TCP
          internal: 1801
  - name: patch-properties
    release: scf-helper
  - name: cfdot
    release: diego
  - name: route_emitter
    release: diego
    consumes:
      routing_api: {ignore: true}
  - name: garden
    release: garden-runc
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        # Instance group needs volume claim templates (see storage below), no LB => clustered
        run:
          scaling:
            min: 1
            max: 254
            # Not sure why 2 isn't enough for HA, but https://docs.cloudfoundry.org/concepts/high-availability.html disagrees
            ha: 3
          privileged: true
          service-account: garden-runc
          volumes:
          - path: /var/vcap/data/grootfs
            type: persistent
            tag: grootfs-data
            size: 50
          - path: /sys/fs/cgroup
            type: host
            tag: host-cgroup
          memory: 2800
          virtual-cpus: 4
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - diego-cell
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - router
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
  - name: groot-btrfs
    release: groot-btrfs
  - name: cflinuxfs3-rootfs-setup
    release: cflinuxfs3
  - name: cf-sle12-setup
    release: cf-sle12
  - name: sle15-rootfs-setup
    release: sle15
  - name: nfsv3driver
    release: nfs-volume
    properties:
      bosh_containerization:
        ports:
        - name: nfs-driver
          protocol: TCP
          internal: 7589
        - name: nfs-admin
          protocol: TCP
          internal: 7590
  - name: mapfs
    release: mapfs
  configuration:
    templates:
      properties.bbs.hostname: '"diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"' # cfdot property
      properties.containers.trusted_ca_certificates: "[((#TRUSTED_CERTS))((TRUSTED_CERTS)),((/TRUSTED_CERTS))((INTERNAL_CA_CERT))]"
      properties.diego.rep.advertise_domain: diego-cell-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
      properties.locket.hostname: '"locket-locket.((KUBERNETES_NAMESPACE))"'    # cfdot property
      properties.tls.ca_cert: ((INTERNAL_CA_CERT))
      properties.tls.ca_certificate: ((INTERNAL_CA_CERT))                   # cfdot property
      properties.tls.cert: ((REP_SERVER_CERT))
      properties.tls.certificate: '"((BBS_REP_CERT))"'                      # cfdot property
      properties.tls.key: ((REP_SERVER_CERT_KEY))
      properties.tls.private_key: '"((BBS_REP_CERT_KEY))"'                  # cfdot property
      properties.uaa.hostname: '((KUBERNETES_NAMESPACE)).((UAA_HOST))'
      properties.uaa.port: ((UAA_PORT))
- name: acceptance-tests-brain
  type: bosh-task
  tags:
  - stop-on-failure
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: acceptance-tests-brain
    release: scf
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: manual
          service-account: tests-brain
- name: acceptance-tests
  type: bosh-task
  tags:
  - stop-on-failure
  scripts:
  - scripts/cf_acceptance_tests_suites.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: acceptance-tests
    release: scf
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: manual
  configuration:
    templates:
      properties.acceptance_tests.flake_attempts: '"((ACCEPTANCE_TEST_FLAKE_ATTEMPTS))"'
      properties.acceptance_tests.nodes: '"((ACCEPTANCE_TEST_NODES))"'
      scf.cats-suites: '"((CATS_SUITES))"'
- name: sync-integration-tests
  type: bosh-task
  tags:
  - stop-on-failure
  jobs:
  - name: global-properties # This needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca
    release: scf
  - name: sync-integration-tests
    release: scf
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 0
            max: 1
          flight-stage: manual
          service-account: tests-sits
  configuration:
    templates:
      properties.sync_integration_tests.bbs.svc.name: diego-api-bbs
      properties.sync_integration_tests.bbs.svc.namespace: ((KUBERNETES_NAMESPACE))
      properties.sync_integration_tests.bbs.svc.port: 8889
      properties.sync_integration_tests.config.bbs_client_cert_contents: '"((BBS_CLIENT_CRT))"'
      properties.sync_integration_tests.config.bbs_client_key_contents: '"((BBS_CLIENT_CRT_KEY))"'
      properties.sync_integration_tests.config.cf_admin_password: '"((CLUSTER_ADMIN_PASSWORD))"'
      properties.sync_integration_tests.config.cf_api: api.((DOMAIN))
      properties.sync_integration_tests.config.cf_apps_domain: ((DOMAIN))
      properties.sync_integration_tests.setup.flake_attempts: "'((SYNC_INTEGRATION_TESTS_FLAKE_ATTEMPTS))'"
      properties.sync_integration_tests.setup.focus: "'((SYNC_INTEGRATION_TESTS_FOCUS))'"
      properties.sync_integration_tests.setup.nodes: "'((SYNC_INTEGRATION_TESTS_NODES))'"
      properties.sync_integration_tests.setup.skip: "'((SYNC_INTEGRATION_TESTS_SKIP))'"
      properties.sync_integration_tests.setup.verbose: "'((SYNC_INTEGRATION_TESTS_VERBOSE))'"
- name: smoke-tests
  type: bosh-task
  tags:
  - stop-on-failure
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: cf-cli-6-linux
    release: cf-cli
  - name: smoke_tests
    release: cf-smoke-tests
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: manual
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.smoke_tests.client_secret: ((UAA_CLIENTS_CF_SMOKE_TESTS_CLIENT_SECRET))
- name: uaa
  if_feature: uaa
  environment_scripts:
  - scripts/log_level_mappings.sh
  scripts:
  - scripts/patches/fix_uaa_monit_timeout.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/fix_uaa_prestart_suse_compat.sh
  - scripts/forward_logfiles.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-uaa-properties # needs to be first so images use it for processing monit templates
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: uaa
    release: uaa
    properties:
      bosh_containerization:
        run:
          scaling:
            ha: 2
            min: 1
            max: 65535
          capabilities: [AUDIT_WRITE]
          persistent-volumes: []
          shared-volumes: []
          memory: 2100
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - >
                curl
                --resolve uaa.${DOMAIN}:8443:$(getent hosts ${HOSTNAME} | awk '{ print $1 }')
                --fail
                -H \"Host: uaa.${DOMAIN}\"
                -H 'Accept: application/json' https://uaa.${DOMAIN}:8443/info
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - uaa
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: uaa
          protocol: TCP
          external: 8080
          internal: 8080
          public: false
        - name: uaa-ssl
          protocol: TCP
          external: 2793
          internal: 8443
          public: true
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  - name: wait-for-database
    release: scf-helper
  tags:
  - sequential-startup
  configuration:
    templates:
      properties.encryption.encryption_keys: '[{"label":"smorgasbrod","passphrase":"((AEK_PASSWORD))"}]'
      properties.login.saml.serviceProviderCertificate: '"((SAML_SERVICEPROVIDER_CERT))"'
      properties.login.saml.serviceProviderKey: '"((SAML_SERVICEPROVIDER_CERT_KEY))"'
      properties.login.smtp.auth: ((SMTP_AUTH))
      properties.login.smtp.from_address: ((SMTP_FROM_ADDRESS))
      properties.login.smtp.host: ((SMTP_HOST))
      properties.login.smtp.password: ((SMTP_PASSWORD))
      properties.login.smtp.port: ((SMTP_PORT))
      properties.login.smtp.starttls: ((SMTP_STARTTLS))
      properties.login.smtp.user: ((SMTP_USER))
      properties.uaa.admin.client_secret: '"((UAA_ADMIN_CLIENT_SECRET))"'
      # Dummy reference to JWT_SIGNING_CERT so that fissile validator doesn't complain that it is not being used
      properties.uaa.jwt.policy.keys: '{"default": {"signingKey": "((JWT_SIGNING_CERT_KEY))((#JWT_SIGNING_CERT))((/JWT_SIGNING_CERT))"}}'
      properties.uaa.logging_level: ((LOG_LEVEL_LOG4J))((#LOG_LEVEL))((/LOG_LEVEL))
      properties.uaa.ssl.port: 8443
      # Save INTERNAL_CA cert and key in the kube secrets, so that a future update can use them to sign additional certs
      properties.uaa.sslCertificate: ((UAA_SERVER_CERT))((#INTERNAL_CA_CERT))((/INTERNAL_CA_CERT))
      properties.uaa.sslPrivateKey: ((UAA_SERVER_CERT_KEY))((#INTERNAL_CA_CERT_KEY))((/INTERNAL_CA_CERT_KEY))
      properties.uaa.url: "https://uaa.((DOMAIN)):((UAA_PUBLIC_PORT))"
      properties.uaa.zones.internal.hostnames: >-
        [
          "uaa",
          "uaa.((KUBERNETES_NAMESPACE))",
          "uaa.((KUBERNETES_NAMESPACE)).svc",
          "uaa.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"
        ]
      properties.uaadb.address: *cf-internal-database-host
      properties.uaadb.port: *cf-internal-database-port
      properties.uaadb.roles: '[{"name": "uaaadmin", "password": "((UAADB_PASSWORD))", "tag": "admin"}]'
      properties.wait-for-database.hostname: *cf-internal-database-host
      properties.wait-for-database.port: *cf-internal-database-port
- name: secret-generation
  type: bosh-task
  jobs:
  - name: generate-secrets
    release: scf-helper
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: pre-flight
          memory: 256
          virtual-cpus: 1
          service-account: secret-generator
  configuration:
    templates:
      properties.scf.secrets.auto_approval: ((KUBE_CSR_AUTO_APPROVAL))
      properties.scf.secrets.cert_expiration: ((CERT_EXPIRATION))
      properties.scf.secrets.cluster_domain: ((KUBERNETES_CLUSTER_DOMAIN))
      properties.scf.secrets.domain: ((DOMAIN))
      properties.scf.secrets.env: '["FEATURE_EIRINI_ENABLED=((FEATURE_EIRINI_ENABLED))"]'
      properties.scf.secrets.generation: ((KUBE_SECRETS_GENERATION_COUNTER))
      properties.scf.secrets.is_install: ((HELM_IS_INSTALL))
      properties.scf.secrets.name: ((KUBE_SECRETS_GENERATION_NAME))
      properties.scf.secrets.namespace: ((KUBERNETES_NAMESPACE))
- name: configure-eirini
  if_feature: eirini
  type: bosh-task
  jobs:
  - name: configure-eirini-scf
    release: eirini
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: post-flight
          memory: 256
          virtual-cpus: 1
          service-account: eirini
- name: post-deployment-setup
  type: bosh-task
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: database-seeder
    release: scf-helper
  - name: uaa-create-user
    release: scf
  - name: configure-scf
    release: scf
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
          flight-stage: post-flight
          memory: 256
          virtual-cpus: 1
  configuration:
    templates:
      properties.database-seeder.driver: ((#DB_EXTERNAL_HOST))((DB_EXTERNAL_DRIVER))((/DB_EXTERNAL_HOST))
      properties.database-seeder.host: ((DB_EXTERNAL_HOST))
      properties.database-seeder.password: ((DB_EXTERNAL_PASSWORD))
      properties.database-seeder.port: ((DB_EXTERNAL_PORT))
      properties.database-seeder.sslmode: ((DB_EXTERNAL_SSL_MODE))
      properties.database-seeder.username: ((DB_EXTERNAL_USER))
      properties.seeded_databases: *seeded_databases
- name: credhub-user
  if_feature: credhub
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  - scripts/credhub_log_level.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/uaa_ca_cert_credhub.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: credhub
    release: credhub
    provides:
      credhub: {}
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 1
            ha: 1
          persistent-volumes: []
          shared-volumes: []
          memory: 2000
          virtual-cpus: 2
          healthcheck:
            readiness:
        ports:
        - name: api #apiserverport
          protocol: TCP
          external: 8844
          internal: 8844
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.credhub.authentication.uaa.ca_certs: '["((UAA_CA_CERT))"]'
      properties.credhub.authentication.uaa.internal_url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))
      properties.credhub.authentication.uaa.url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))
      properties.credhub.authorization.acls.enabled: false
      properties.credhub.data_storage.database: "credhub_user"
      properties.credhub.data_storage.host: *cf-internal-database-host
      properties.credhub.data_storage.password: ((MYSQL_CREDHUB_USER_PASSWORD))
      properties.credhub.data_storage.port: *cf-internal-database-port
      # require_tls must be set also when UAA is using the INTERNAL_CA_CERT
      properties.credhub.data_storage.require_tls: true
      properties.credhub.data_storage.tls_ca: ((INTERNAL_CA_CERT))
      properties.credhub.data_storage.type: "mysql"
      properties.credhub.data_storage.username: "credhub_user"
      properties.credhub.encryption.keys: '[{"provider_name":"internal-provider", "active":true, "key_properties":{"encryption_password":"((CREDHUB_ENCRYPT_KEY))"}}]'
      properties.credhub.encryption.providers: '[{"name":"internal-provider", "type":"internal"}]'
      properties.credhub.log_level: '"((CREDHUB_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
      properties.credhub.tls: '{"certificate":"((CREDHUB_SERVER_CERT))","private_key":"((CREDHUB_SERVER_CERT_KEY))"}'
      properties.route_registrar.routes: '[{"name":"credhub", "tls_port":8844, "server_cert_domain_san":"credhub-set", "tags":{"component":"credhub"}, "uris":["credhub.((DOMAIN))"], "registration_interval":"10s"}]'
- name: autoscaler-postgres
  if_feature: autoscaler
  scripts:
  - scripts/chown_vcap_store.sh
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  - scripts/patches/fix_postgres_prestart.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: postgres
    release: postgres
    properties:
      bosh_containerization:
        run:
          scaling:
            # The postgres-release BOSH release currently does not support HA; limit this to one replica.
            # https://github.com/cloudfoundry/postgres-release#known-limitations
            min: 1
            max: 1
            ha: 1
          volumes:
          - path: /var/vcap/store
            type: persistent
            tag: postgres-data
            size: 5
          memory: 1024
          virtual-cpus: 2
        ports:
        - name: postgres
          protocol: TCP
          external: 5432
          internal: 5432
  configuration:
    templates:
      properties.databases.databases: '[{"name":"autoscaler","tag":"default"}]'
      properties.databases.port: '"((AUTOSCALER_DB_PORT))"'
      properties.databases.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
- name: autoscaler-api
  if_feature: autoscaler
  environment_scripts:
  - scripts/configure-HA-hosts.sh
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: apiserver
    release: app-autoscaler
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 256
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:9101
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - autoscaler-api
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: api  # apiserverport
          protocol: TCP
          external: 7100
          internal: 7100
        - name: apihealthport
          protocol: TCP
          external: 9101
          internal: 9101
  - name: route_registrar
    release: routing
    consumes:
      nats: {ignore: true}
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.route_registrar.routes: '[{"name":"autoscalerapiserver", "port":7106, "tags":{"component":"autoscalerapiserver"}, "uris":["autoscaler.((DOMAIN))"], "registration_interval":"10s"}]'
- name: autoscaler-metrics
  if_feature: autoscaler
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: metricscollector
    release: app-autoscaler
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 1024
          virtual-cpus: 4
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:9103
              - curl --silent --fail --head http://${HOSTNAME}:9105
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - autoscaler-metrics
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: metrics  # metricscollectorport
          protocol: TCP
          external: 7103
          internal: 7103
        - name: mchealthport
          protocol: TCP
          external: 9103
          internal: 9103
  - name: eventgenerator
    release: app-autoscaler
    properties:
      bosh_containerization:
        ports:
        - name: eventgen  # eventgeneratorport
          protocol: TCP
          external: 7105
          internal: 7105
        - name: eghealthport
          protocol: TCP
          external: 9105
          internal: 9105
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: autoscaler-actors
  if_feature: autoscaler
  scripts:
  - scripts/forward_logfiles.sh
  - scripts/patches/fix_monit_rsyslog.sh
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: authorize-internal-ca # needs to be second as it is a dependency of other jobs.
    release: scf
  - name: scheduler
    release: app-autoscaler
    properties:
      bosh_containerization:
        colocated_containers:
        - loggregator-agent
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
          memory: 2350
          virtual-cpus: 2
          healthcheck:
            readiness:
              command:
              - curl --silent --fail --head http://${HOSTNAME}:9102
              - curl --silent --fail --head http://${HOSTNAME}:9104
              - curl --silent --fail --head http://${HOSTNAME}:9108
          affinity:
            podAntiAffinity:
              preferredDuringSchedulingIgnoredDuringExecution:
              - weight: 100
                podAffinityTerm:
                  labelSelector:
                    matchExpressions:
                    - key: "app.kubernetes.io/component"
                      operator: In
                      values:
                      - autoscaler-actors
                  topologyKey: '{{if eq (typeOf .Values.kube.podAntiAffinityTopologyKey) "<nil>"}}kubernetes.io/hostname{{else}}{{.Values.kube.podAntiAffinityTopologyKey}}{{end}}'
        ports:
        - name: scheduler  # schedulerport
          protocol: TCP
          external: 7102
          internal: 7102
        - name: sdhealthport
          protocol: TCP
          external: 9102
          internal: 9102
  - name: scalingengine
    release: app-autoscaler
    properties:
      bosh_containerization:
        ports:
        - name: scaling-engine  # scalingengineport
          protocol: TCP
          external: 7104
          internal: 7104
        - name: sehealthport
          protocol: TCP
          external: 9104
          internal: 9104
  - name: operator
    release: app-autoscaler
    properties:
      bosh_containerization:
        ports:
        - name: ophealthport
          protocol: TCP
          external: 9108
          internal: 9108
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
- name: loggregator-agent
  type: colocated-container
  post_config_scripts:
  - scripts/bpm_kube_dns.rb
  jobs:
  - name: global-properties # needs to be first so images use it for processing monit templates.
    release: scf-helper
  - name: loggregator_agent
    release: loggregator-agent
    properties:
      bosh_containerization:
        run:
          scaling:
            min: 1
            max: 3
            ha: 2
  - name: prom_scraper
    release: loggregator-agent
  - name: bpm
    release: bpm
    properties:
      bosh_containerization:
        run:
          privileged: true
  configuration:
    templates:
      properties.fissile.monit.port: 2290
      properties.metrics.ca_cert: ((INTERNAL_CA_CERT))
      properties.metrics.cert: ((PROM_SCRAPER_METRICS_TLS_CERT))
      properties.metrics.key: ((PROM_SCRAPER_METRICS_TLS_CERT_KEY))
      properties.metrics.server_name: prom_scraper_metrics
      properties.scrape.tls.ca_cert: ((INTERNAL_CA_CERT))
      properties.scrape.tls.cert: ((PROM_SCRAPER_SCRAPE_TLS_CERT))
      properties.scrape.tls.key: ((PROM_SCRAPER_SCRAPE_TLS_CERT_KEY))
configuration:
  auth:
    roles:
      active-passive:
      - apiGroups: [""]
        resources: [pods]
        verbs: [patch]
      # switchboard-leader for mysql-proxy is annotating services
      - apiGroups: [""]
        resources: [services]
        verbs: [get, list, patch]
      configgin:
      - apiGroups: [""]
        resources: [pods]
        verbs: [get, list]
      - apiGroups: [""]
        resources: [services]
        verbs: [get]
      - apiGroups: [apps]
        resources: [statefulsets]
        verbs: [get, patch]
      - apiGroups: [""]
        resources: [secrets]
        verbs: [create, get, update, delete]
      garden-runc:
      - apiGroups: [""]
        resources: [pods]
        verbs: [get]
      psp:
      - apiGroups: [extensions]
        resourceNames: [default]
        resources: [podsecuritypolicies]
        verbs: [use]
      secrets:
      - apiGroups: [""]
        resources: [configmaps, secrets]
        verbs: [create, get, list, patch, update, delete]
      services:
      - apiGroups: [""]
        resources: [services]
        verbs: [get]
      test-brain:
      - apiGroups: [""]
        resources: [services]
        verbs: [create, get, delete]
      - apiGroups: [extensions]
        resources: [replicasets]
        verbs: [create, get, list, delete, update]
      - apiGroups: [apps]
        resources: [statefulsets]
        verbs: [create, get, update, delete, list]
      - apiGroups: [""]
        resources: ["pods"]
        verbs: [create, get, list, delete, update]
      - apiGroups: [""]
        resources: ["pods/exec"]
        verbs: [create, delete]
      - apiGroups: [""]
        resources: ["pods/log"]
        verbs: [create, delete, get, list]
      - apiGroups: [""]
        resources: [secrets]
        verbs: [get, list]
      test-sits:
      - apiGroups: [""]
        resources: [pods, pods/portforward]
        verbs: [get, list, create]
      - apiGroups: [""]
        resources: [services]
        verbs: [get]
    cluster-roles:
      test-cluster:
      - apiGroups: [""]
        resources: [namespaces]
        verbs: [create, get, delete]
      - apiGroups: [""]
        resources: [pods, pods/log, namespaces]
        verbs: [get, list, watch]
      - apiGroups: [""]
        resources: [pods/portforward]
        verbs: [create]
      - apiGroups: ["rbac.authorization.k8s.io"]
        resources: [clusterrolebindings]
        verbs: [delete]
      - apiGroups: [""]
        resources: [persistentvolumes, persistentvolumeclaims]
        verbs: [get, list, delete]
      - apiGroups: [storage.k8s.io]
        resources: [storageclasses]
        verbs: [get, list]
      - apiGroups: [batch]
        resources: [jobs]
        verbs: [get, list]
    pod-security-policies:
      default:
        allowPrivilegeEscalation: true
        allowedCapabilities: ["*"]
        defaultAllowPrivilegeEscalation: true
        fsGroup: { rule: RunAsAny }
        hostPorts: [{ min: 0, max: 65535 }]
        privileged: true
        runAsUser: { rule: RunAsAny }
        seLinux: { rule: RunAsAny }
        supplementalGroups: { rule: RunAsAny }
        volumes:
        - configMap
        - secret
        - emptyDir
        - downwardAPI
        - projected
        - persistentVolumeClaim
        - nfs
    accounts:
      active-passive:
        roles: [active-passive, psp]
      configgin:
        roles: [configgin, psp]
      default:
        roles: [psp]
      eirini:
        # etc/scf/config/scripts/set-opi-registry-port.sh needs "get service"
        roles: [services, psp]
      garden-runc:
        roles: [garden-runc, psp]
      secret-generator:
        # Include configgin role so that we don't deadlock with configgin-helper
        roles: [configgin, secrets, psp]
      tests-brain:
        roles: [test-brain, psp]
        cluster-roles: [test-cluster]
      tests-sits:
        roles: [test-sits, psp]
  templates:
    az: '"((KUBE_AZ))"'
    id: ((HOSTNAME))
    index: ((KUBE_COMPONENT_INDEX))((^KUBE_COMPONENT_INDEX))0((/KUBE_COMPONENT_INDEX))
    ip: '"((IP_ADDRESS))"'
    name: ((HOSTNAME))
    networks.default.dns_record_name: '"((DNS_RECORD_NAME))"'
    networks.default.ip: '"((IP_ADDRESS))"'
    # We include INTERNAL_CA_CERT_KEY here so validation doesn't complain that it's not being used.
    # we can't make it internal, as that exposes it everywhere. The acceptance tests are not used at runtime so it's safe.
    properties.acceptance_tests.admin_password: '"((CLUSTER_ADMIN_PASSWORD))"'
    properties.acceptance_tests.api: '"api.((DOMAIN))"'
    properties.acceptance_tests.apps_domain: '"((DOMAIN))"'
    properties.acceptance_tests_brain.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.acceptance_tests_brain.ca_cert_uaa: '"((UAA_CA_CERT))"'
    properties.acceptance_tests_brain.domain: '"((DOMAIN))"'
    properties.acceptance_tests_brain.namespace: '"((KUBERNETES_NAMESPACE))"'
    properties.acceptance_tests_brain.password: '"((CLUSTER_ADMIN_PASSWORD))"'
    properties.acceptance_tests_brain.storage_class: '"((KUBERNETES_STORAGE_CLASS_PERSISTENT))"'
    properties.acceptance_tests_brain.tcp_domain: '"((TCP_DOMAIN))"'
    properties.app_domains: '["((DOMAIN))"]'
    properties.app_ssh.host_key_fingerprint: '"((APP_SSH_KEY_FINGERPRINT))"'
    properties.autoscaler.api_server.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.eventgenerator.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.eventgenerator.client_cert: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT))"'
    properties.autoscaler.api_server.eventgenerator.client_key: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT_KEY))"'
    properties.autoscaler.api_server.eventgenerator.host: '"autoscaler-metrics-eventgenerator.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.autoscaler.api_server.metrics_collector.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.metrics_collector.client_cert: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT))"'
    properties.autoscaler.api_server.metrics_collector.client_key: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT_KEY))"'
    properties.autoscaler.api_server.metrics_collector.host: '"autoscaler-metrics-metricscollector.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.autoscaler.api_server.public_ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.public_server_cert: '"((AUTOSCALER_ASAPI_PUBLIC_SERVER_CERT))"'
    properties.autoscaler.api_server.public_server_key: '"((AUTOSCALER_ASAPI_PUBLIC_SERVER_CERT_KEY))"'
    properties.autoscaler.api_server.scaling_engine.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.scaling_engine.client_cert: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT))"'
    properties.autoscaler.api_server.scaling_engine.client_key: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT_KEY))"'
    properties.autoscaler.api_server.scaling_engine.host: '"autoscaler-actors-scalingengine.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.autoscaler.api_server.scheduler.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.api_server.scheduler.client_cert: '"((AUTOSCALER_SCHEDULER_CLIENT_CERT))"'
    properties.autoscaler.api_server.scheduler.client_key: '"((AUTOSCALER_SCHEDULER_CLIENT_CERT_KEY))"'
    properties.autoscaler.api_server.scheduler.host: '"autoscaler-actors-scheduler.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.autoscaler.api_server.server_cert: '"((AUTOSCALER_ASAPI_SERVER_CERT))"'
    properties.autoscaler.api_server.server_key: '"((AUTOSCALER_ASAPI_SERVER_CERT_KEY))"'
    properties.autoscaler.appmetrics_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.appmetrics_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.appmetrics_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.autoscaler.cf.api: '"https://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9024"'
    properties.autoscaler.cf.secret: '"((AUTOSCALER_UAA_CLIENT_SECRET))"'
    properties.autoscaler.eventgenerator.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.eventgenerator.metricscollector.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.eventgenerator.metricscollector.client_cert: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT))"'
    properties.autoscaler.eventgenerator.metricscollector.client_key: '"((AUTOSCALER_ASMETRICS_CLIENT_CERT_KEY))"'
    properties.autoscaler.eventgenerator.scaling_engine.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.eventgenerator.scaling_engine.client_cert: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT))"'
    properties.autoscaler.eventgenerator.scaling_engine.client_key: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT_KEY))"'
    properties.autoscaler.eventgenerator.scaling_engine.host: '"autoscaler-actors-scalingengine.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.autoscaler.eventgenerator.server_cert: '"((AUTOSCALER_ASMETRICS_SERVER_CERT))"'
    properties.autoscaler.eventgenerator.server_key: '"((AUTOSCALER_ASMETRICS_SERVER_CERT_KEY))"'
    properties.autoscaler.instancemetrics_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.instancemetrics_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.instancemetrics_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.autoscaler.lock_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.lock_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.lock_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.autoscaler.metricscollector.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.metricscollector.server_cert: '"((AUTOSCALER_ASMETRICS_SERVER_CERT))"'
    properties.autoscaler.metricscollector.server_key: '"((AUTOSCALER_ASMETRICS_SERVER_CERT_KEY))"'
    properties.autoscaler.operator.scaling_engine.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.operator.scaling_engine.client_cert: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT))"'
    properties.autoscaler.operator.scaling_engine.client_key: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT_KEY))"'
    properties.autoscaler.operator.scheduler.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.operator.scheduler.client_cert: '"((AUTOSCALER_SCHEDULER_CLIENT_CERT))"'
    properties.autoscaler.operator.scheduler.client_key: '"((AUTOSCALER_SCHEDULER_CLIENT_CERT_KEY))"'
    properties.autoscaler.policy_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.policy_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.policy_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.autoscaler.scalingengine.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.scalingengine.server_cert: '"((AUTOSCALER_SCALING_ENGINE_SERVER_CERT))"'
    properties.autoscaler.scalingengine.server_key: '"((AUTOSCALER_SCALING_ENGINE_SERVER_CERT_KEY))"'
    properties.autoscaler.scalingengine_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.scalingengine_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.scalingengine_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.autoscaler.scheduler.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.scheduler.scaling_engine.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.autoscaler.scheduler.scaling_engine.client_cert: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT))"'
    properties.autoscaler.scheduler.scaling_engine.client_key: '"((AUTOSCALER_SCALING_ENGINE_CLIENT_CERT_KEY))"'
    properties.autoscaler.scheduler.server_cert: '"((AUTOSCALER_SCHEDULER_SERVER_CERT))"'
    properties.autoscaler.scheduler.server_key: '"((AUTOSCALER_SCHEDULER_SERVER_CERT_KEY))"'
    properties.autoscaler.scheduler_db.address: '((AUTOSCALER_DB_ADDRESS))'
    properties.autoscaler.scheduler_db.port: '"((AUTOSCALER_DB_PORT))"'
    properties.autoscaler.scheduler_db.roles: '[{"name": "((AUTOSCALER_DB_ROLE_NAME))", "password": "((AUTOSCALER_DB_PASSWORD))", "tag": "default"}]'
    properties.bits-service.active_signing_key.secret: "((BITS_SERVICE_SECRET))"
    properties.bits-service.app_stash.webdav_config.ca_cert: "((INTERNAL_CA_CERT))"
    properties.bits-service.app_stash.webdav_config.password: "((BLOBSTORE_PASSWORD))"
    properties.bits-service.app_stash.webdav_config.private_endpoint: "https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443"
    properties.bits-service.app_stash.webdav_config.public_endpoint: "https://blobstore.((DOMAIN))"
    properties.bits-service.buildpacks.webdav_config.ca_cert: ((INTERNAL_CA_CERT))
    properties.bits-service.buildpacks.webdav_config.password: ((BLOBSTORE_PASSWORD))
    properties.bits-service.buildpacks.webdav_config.private_endpoint: "https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443"
    properties.bits-service.buildpacks.webdav_config.public_endpoint: "https://blobstore.((DOMAIN))"
    properties.bits-service.cc_updates.ca_cert: ((INTERNAL_CA_CERT))
    properties.bits-service.cc_updates.cc_url: "https://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9024/internal/v4/packages"
    properties.bits-service.cc_updates.client_cert: ((CC_PUBLIC_TLS_CERT))
    properties.bits-service.cc_updates.client_key: ((CC_PUBLIC_TLS_CERT_KEY))
    properties.bits-service.droplets.webdav_config.ca_cert: ((INTERNAL_CA_CERT))
    properties.bits-service.droplets.webdav_config.password: ((BLOBSTORE_PASSWORD))
    properties.bits-service.droplets.webdav_config.private_endpoint: "https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443"
    properties.bits-service.droplets.webdav_config.public_endpoint: "https://blobstore.((DOMAIN))"
    properties.bits-service.packages.webdav_config.ca_cert: ((INTERNAL_CA_CERT))
    properties.bits-service.packages.webdav_config.password: ((BLOBSTORE_PASSWORD))
    properties.bits-service.packages.webdav_config.private_endpoint: "https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443"
    properties.bits-service.packages.webdav_config.public_endpoint: https://blobstore.((DOMAIN))
    properties.bits-service.private_endpoint: "https://bits-bits-service.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"
    properties.bits-service.public_endpoint: "https://bits.((DOMAIN))"
    properties.bits-service.tls.cert: ((BITS_SERVICE_SSL_CERT))
    properties.bits-service.tls.key: ((BITS_SERVICE_SSL_CERT_KEY))
    properties.blobstore.admin_users: '[{"username": "blobstore_user", "password": "((BLOBSTORE_PASSWORD))"}]'
    properties.blobstore.internal_access_rules: '[((BLOBSTORE_ACCESS_RULES))]'
    properties.blobstore.max_upload_size: ((BLOBSTORE_MAX_UPLOAD_SIZE))m
    properties.blobstore.secure_link.secret: '"((BLOBSTORE_SECURE_LINK))"'
    properties.blobstore.tls.cert: '"((BLOBSTORE_TLS_CERT))"'
    properties.blobstore.tls.private_key: '"((BLOBSTORE_TLS_CERT_KEY))"'
    properties.build: '"((CLUSTER_BUILD))"'
    properties.capi.cc_uploader.cc.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.capi.cc_uploader.cc.client_cert: '"((CC_SERVER_CRT))"'
    properties.capi.cc_uploader.cc.client_key: '"((CC_SERVER_CRT_KEY))"'
    properties.capi.cc_uploader.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.capi.cc_uploader.mutual_tls.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.capi.cc_uploader.mutual_tls.server_cert: '"((CC_UPLOADER_CRT))"'
    properties.capi.cc_uploader.mutual_tls.server_key: '"((CC_UPLOADER_CRT_KEY))"'
    properties.capi.tps.bbs.api_location: diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.capi.tps.bbs.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.capi.tps.bbs.client_cert: '"((BBS_CLIENT_CRT))"'
    properties.capi.tps.bbs.client_key: '"((BBS_CLIENT_CRT_KEY))"'
    properties.capi.tps.cc.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.capi.tps.cc.client_cert: '"((TPS_CC_CLIENT_CRT))"'
    properties.capi.tps.cc.client_key: '"((TPS_CC_CLIENT_CRT_KEY))"'
    properties.capi.tps.cc.internal_service_hostname: api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    properties.capi.tps.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.capi.tps.traffic_controller_url: wss://log-api-loggregator-trafficcontroller.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8081
    properties.capi.tps.watcher.locket.api_location: '"locket-locket.((KUBERNETES_NAMESPACE)):8891"'
    properties.cc.allow_app_ssh_access: ((ALLOW_APP_SSH_ACCESS))
    properties.cc.allowed_cors_domains: ((ALLOWED_CORS_DOMAINS))
    properties.cc.app_bits_max_body_size: ((NGINX_MAX_REQUEST_BODY_SIZE))M
    properties.cc.app_bits_upload_grace_period_in_seconds: ((APP_TOKEN_UPLOAD_GRACE_PERIOD))
    properties.cc.broker_client_timeout_seconds: '"((BROKER_CLIENT_TIMEOUT_SECONDS))"'
    properties.cc.buildpacks.cdn.uri: '"((CDN_URI))"'
    properties.cc.buildpacks.webdav_config.password: '"((BLOBSTORE_PASSWORD))"'
    properties.cc.buildpacks.webdav_config.private_endpoint: https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443
    properties.cc.buildpacks.webdav_config.public_endpoint: '"https://blobstore.((DOMAIN))"'
    properties.cc.bulk_api_password: '"((BULK_API_PASSWORD))"'
    properties.cc.database_encryption.current_key_label: '"((CC_DB_CURRENT_KEY_LABEL))"'
    properties.cc.database_encryption.keys: ((CC_DB_ENCRYPTION_KEYS))
    properties.cc.db_encryption_key: '"((DB_ENCRYPTION_KEY))"'
    properties.cc.default_app_disk_in_mb: '"((DEFAULT_APP_DISK_IN_MB))"'
    properties.cc.default_app_memory: '"((DEFAULT_APP_MEMORY))"'
    properties.cc.default_app_ssh_access: '"((DEFAULT_APP_SSH_ACCESS))"'
    properties.cc.default_stack: '"((DEFAULT_STACK))((#FEATURE_EIRINI_ENABLED))((/FEATURE_EIRINI_ENABLED))"'
    properties.cc.diego.bbs.url: https://diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.cc.diego.cc_uploader_https_url: https://cc-uploader-cc-uploader.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9091
    properties.cc.diego.docker_staging_stack: '"((DEFAULT_STACK))"'
    properties.cc.diego.file_server_url: https://diego-access.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8443
    properties.cc.diego.insecure_docker_registry_list: '[((INSECURE_DOCKER_REGISTRIES))]'
    properties.cc.diego.use_privileged_containers_for_running: ((USE_DIEGO_PRIVILEGED_CONTAINERS))
    properties.cc.diego.use_privileged_containers_for_staging: ((USE_STAGER_PRIVILEGED_CONTAINERS))
    properties.cc.disable_custom_buildpacks: ((DISABLE_CUSTOM_BUILDPACKS))
    properties.cc.droplets.max_staged_droplets_stored: ((DROPLET_MAX_STAGED_STORED))
    properties.cc.droplets.webdav_config.password: '"((BLOBSTORE_PASSWORD))"'
    properties.cc.droplets.webdav_config.private_endpoint: https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443
    properties.cc.droplets.webdav_config.public_endpoint: '"https://blobstore.((DOMAIN))"'
    properties.cc.internal_api_password: '"((INTERNAL_API_PASSWORD))"'
    properties.cc.internal_service_hostname: api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    properties.cc.logging_level: '"((LOG_LEVEL))"'
    properties.cc.loggregator.internal_url: https://log-api-loggregator-trafficcontroller.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8081
    properties.cc.maximum_app_disk_in_mb: ((MAX_APP_DISK_IN_MB))
    properties.cc.maximum_health_check_timeout: ((MAX_HEALTH_CHECK_TIMEOUT))
    properties.cc.mutual_tls.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.cc.mutual_tls.private_key: '"((CC_SERVER_CRT_KEY))"'
    properties.cc.mutual_tls.public_cert: '"((CC_SERVER_CRT))"'
    properties.cc.nginx_error_log_level: '"((NGINX_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.cc.opi.ca_cert: "((INTERNAL_CA_CERT))"
    properties.cc.opi.client_cert: "((EIRINI_CLIENT_CRT))"
    properties.cc.opi.client_key: "((EIRINI_CLIENT_CRT_KEY))"
    properties.cc.opi.enabled: ((FEATURE_EIRINI_ENABLED))
    properties.cc.opi.opi_staging: ((FEATURE_EIRINI_ENABLED))
    properties.cc.opi.url: https://eirini-opi.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8484
    properties.cc.packages.webdav_config.password: '"((BLOBSTORE_PASSWORD))"'
    properties.cc.packages.webdav_config.private_endpoint: https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443
    properties.cc.packages.webdav_config.public_endpoint: '"https://blobstore.((DOMAIN))"'
    properties.cc.public_tls.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.cc.public_tls.certificate: '"((CC_PUBLIC_TLS_CERT))"'
    properties.cc.public_tls.private_key: '"((CC_PUBLIC_TLS_CERT_KEY))"'
    properties.cc.resource_pool.webdav_config.password: '"((BLOBSTORE_PASSWORD))"'
    properties.cc.resource_pool.webdav_config.private_endpoint: https://blobstore-blobstore.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):4443
    properties.cc.resource_pool.webdav_config.public_endpoint: '"https://blobstore.((DOMAIN))"'
    properties.cc.security_event_logging.enabled: '"((ENABLE_SECURITY_EVENT_LOGGING))"'
    properties.cc.staging_timeout_in_seconds: ((STAGING_TIMEOUT))
    properties.cc.staging_upload_password: '"((STAGING_UPLOAD_PASSWORD))"'
    properties.cc.uaa.internal_url: ((KUBERNETES_NAMESPACE)).((UAA_HOST))
    properties.ccdb.address: *cf-internal-database-host
    properties.ccdb.port: *cf-internal-database-port
    properties.ccdb.roles: '[{"name": "ccadmin", "password": "((MYSQL_CCDB_ROLE_PASSWORD))", "tag": "admin"}]'
    properties.cf-sle12.trusted_certs: '"((ROOTFS_TRUSTED_CERTS))((#ROOTFS_TRUSTED_CERTS))\n((/ROOTFS_TRUSTED_CERTS))((INTERNAL_CA_CERT))"'
    properties.cf-usb.broker.external_url: '"https://cf-usb.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):24054"'
    properties.cf-usb.broker.password: '"((CF_USB_PASSWORD))"'
    properties.cf-usb.broker.server_cert: '"((CF_USB_BROKER_SERVER_CERT))"'
    properties.cf-usb.broker.server_key: '"((CF_USB_BROKER_SERVER_CERT_KEY))"'
    properties.cf-usb.management.uaa.secret: '"((UAA_CLIENTS_CF_USB_SECRET))"'
    properties.cf-usb.mysql_address: *cf-internal-database-host
    properties.cf-usb.mysql_password: "((MYSQL_CF_USB_PASSWORD))"
    properties.cf.insecure_api_url: http://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9022 # For post-deployment-setup, because cf cli has no client certs.
    properties.cflinuxfs3-rootfs.trusted_certs: '"((ROOTFS_TRUSTED_CERTS))((#ROOTFS_TRUSTED_CERTS))\n((/ROOTFS_TRUSTED_CERTS))((INTERNAL_CA_CERT))"'
    properties.containers.trusted_ca_certificates: '((#TRUSTED_CERTS))[((TRUSTED_CERTS))]((/TRUSTED_CERTS))'
    properties.copilot.client_ca_file: ((INTERNAL_CA_CERT))
    # CLUSTER_DESCRIPTION is not wrapped in quotes because it has quotes in the dev env file.
    properties.description: ((CLUSTER_DESCRIPTION))
    properties.diego.auctioneer.bbs.api_location: diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.diego.auctioneer.bbs.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.auctioneer.bbs.client_cert: '"((BBS_CLIENT_CRT))"'
    properties.diego.auctioneer.bbs.client_key: '"((BBS_CLIENT_CRT_KEY))"'
    properties.diego.auctioneer.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.auctioneer.locket.api_location: '"locket-locket.((KUBERNETES_NAMESPACE)):8891"'
    properties.diego.auctioneer.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.auctioneer.rep.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.auctioneer.rep.client_cert: '"((AUCTIONEER_REP_CERT))"'
    properties.diego.auctioneer.rep.client_key: '"((AUCTIONEER_REP_CERT_KEY))"'
    properties.diego.auctioneer.server_cert: '"((AUCTIONEER_SERVER_CERT))"'
    properties.diego.auctioneer.server_key: '"((AUCTIONEER_SERVER_CERT_KEY))"'
    properties.diego.bbs.auctioneer.api_location: diego-brain-auctioneer.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9016
    properties.diego.bbs.auctioneer.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.bbs.auctioneer.client_cert: '"((BBS_AUCTIONEER_CERT))"'
    properties.diego.bbs.auctioneer.client_key: '"((BBS_AUCTIONEER_CERT_KEY))"'
    properties.diego.bbs.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.bbs.encryption_keys: '[{"label": "active", "passphrase": "((BBS_ACTIVE_KEY_PASSPHRASE))"}]'
    properties.diego.bbs.locket.api_location: '"locket-locket.((KUBERNETES_NAMESPACE)):8891"'
    properties.diego.bbs.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.bbs.rep.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.bbs.rep.client_cert: '"((BBS_REP_CERT))"'
    properties.diego.bbs.rep.client_key: '"((BBS_REP_CERT_KEY))"'
    properties.diego.bbs.server_cert: '"((BBS_SERVER_CRT))"'
    properties.diego.bbs.server_key: '"((BBS_SERVER_CRT_KEY))"'
    properties.diego.bbs.sql.ca_cert: ((INTERNAL_CA_CERT))
    properties.diego.bbs.sql.db_host: *cf-internal-database-host
    properties.diego.bbs.sql.db_password: ((MYSQL_DIEGO_PASSWORD))
    properties.diego.executor.disk_capacity_mb: ((DIEGO_CELL_DISK_CAPACITY_MB))
    properties.diego.executor.memory_capacity_mb: ((DIEGO_CELL_MEMORY_CAPACITY_MB))
    properties.diego.file_server.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.locket.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.locket.sql.db_host: *cf-internal-database-host
    properties.diego.locket.sql.db_password: '"((MYSQL_DIEGO_LOCKET_PASSWORD))"'
    properties.diego.rep.bbs.api_location: diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.diego.rep.cell_id: ((HOSTNAME))
    properties.diego.rep.locket.api_location: locket-locket.((KUBERNETES_NAMESPACE)):8891
    properties.diego.rep.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.rep.placement_tags: "[((KUBE_PZ))]"
    properties.diego.rep.zone: '"((KUBE_AZ))"'
    properties.diego.route_emitter.bbs.api_location: diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.diego.route_emitter.bbs.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.route_emitter.bbs.client_cert: '"((BBS_CLIENT_CRT))"'
    properties.diego.route_emitter.bbs.client_key: '"((BBS_CLIENT_CRT_KEY))"'
    properties.diego.route_emitter.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.route_emitter.nats.machines: ((KUBE_NATS_CLUSTER_IPS))
    properties.diego.route_emitter.nats.password: '"((NATS_PASSWORD))"'
    properties.diego.ssh_proxy.bbs.api_location: diego-api-bbs.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8889
    properties.diego.ssh_proxy.bbs.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.diego.ssh_proxy.bbs.client_cert: '"((BBS_CLIENT_CRT))"'
    properties.diego.ssh_proxy.bbs.client_key: '"((BBS_CLIENT_CRT_KEY))"'
    properties.diego.ssh_proxy.cc.internal_service_hostname: api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    properties.diego.ssh_proxy.host_key: '"((APP_SSH_KEY))"'
    properties.diego.ssh_proxy.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.diego.ssh_proxy.uaa.ca_cert: '"((UAA_CA_CERT))"'
    properties.diego.ssh_proxy.uaa.port: ((UAA_PORT))
    properties.diego.ssh_proxy.uaa.url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST))
    properties.diego.ssh_proxy.uaa_secret: '"((UAA_CLIENTS_DIEGO_SSH_PROXY_SECRET))"'
    properties.domain: '"((DOMAIN))"'
    properties.eirini-loggregator-bridge.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.eirini-loggregator-bridge.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.eirini-loggregator-bridge.loggregator_ca: '((INTERNAL_CA_CERT))'
    properties.eirini-loggregator-bridge.loggregator_cert: '((LOGGREGATOR_FORWARD_CERT))'
    properties.eirini-loggregator-bridge.loggregator_endpoint: "doppler-doppler.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8082"
    properties.eirini-loggregator-bridge.loggregator_key: '((LOGGREGATOR_FORWARD_CERT_KEY))'
    properties.eirini-loggregator-bridge.namespace: '((EIRINI_KUBE_NAMESPACE))'
    properties.eirini-persi-broker.auth_password: '"((EIRINI_PERSI_NFS_BROKER_PASSWORD))"'
    properties.eirini-persi-broker.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.eirini-persi-broker.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.eirini-persi-broker.namespace: "((EIRINI_KUBE_NAMESPACE))"
    properties.eirini-persi-broker.service_plans: '((EIRINI_PERSI_PLANS))'
    properties.eirini-persi-broker.url: 'http://eirini-persi-eirini-persi-broker.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8999'
    properties.eirini-persi.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.eirini-persi.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.eirini-persi.namespace: "((EIRINI_KUBE_NAMESPACE))"
    properties.eirini-persi.operator_webhook_namespace: "((KUBERNETES_NAMESPACE))"
    properties.eirini-ssh-extension.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.eirini-ssh-extension.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.eirini-ssh-extension.namespace: "((EIRINI_KUBE_NAMESPACE))"
    properties.eirini-ssh-extension.operator_webhook_namespace: "((KUBERNETES_NAMESPACE))"
    properties.eirini-ssh-proxy.api_url: 'https://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9024' # TODO: Handle https cert in eirini-ssh-proxy, now currently skips validation
    properties.eirini-ssh-proxy.cc.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.eirini-ssh-proxy.host_key: '"((APP_SSH_KEY))"'
    properties.eirini-ssh-proxy.kube_namespace: "((EIRINI_KUBE_NAMESPACE))"
    properties.eirini-ssh-proxy.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.eirini-ssh-proxy.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.eirini-ssh-proxy.port: '"((EIRINI_SSH_PORT))"'
    properties.eirini-ssh-proxy.uaa.ca_cert: '"((UAA_CA_CERT))((^UAA_CA_CERT))((INTERNAL_CA_CERT))((/UAA_CA_CERT))"'
    properties.external_cert: '"((LOG_CACHE_CF_AUTH_PROXY_EXTERNAL_CERT))"'
    properties.external_key: '"((LOG_CACHE_CF_AUTH_PROXY_EXTERNAL_CERT_KEY))"'
    properties.fissile.monit.password: '"((MONIT_PASSWORD))"'
    properties.garden.apparmor_profile: '"((GARDEN_APPARMOR_PROFILE))"' # Quoting needed to pass through empty string
    properties.garden.btrfs-active: "((^GARDEN_DISABLE_BTRFS))true((/GARDEN_DISABLE_BTRFS))"
    properties.garden.dns_servers: '[((GARDEN_LINUX_DNS_SERVER))]'
    properties.garden.docker_registry_endpoint: ((GARDEN_DOCKER_REGISTRY))((^GARDEN_DOCKER_REGISTRY))null((/GARDEN_DOCKER_REGISTRY))
    properties.garden.http_proxy: '"((HTTP_PROXY))"'
    properties.garden.https_proxy: '"((HTTPS_PROXY))"'
    properties.garden.image_plugin: "((^GARDEN_DISABLE_BTRFS))/var/vcap/packages/groot-btrfs/bin/groot-btrfs((/GARDEN_DISABLE_BTRFS))"
    properties.garden.image_plugin_extra_args: ((^GARDEN_DISABLE_BTRFS))["--config", "/var/vcap/jobs/groot-btrfs/config/groot-btrfs.yaml"]((/GARDEN_DISABLE_BTRFS))
    properties.garden.insecure_docker_registry_list: '[((INSECURE_DOCKER_REGISTRIES))]'
    properties.garden.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.garden.network_mtu: ((DIEGO_CELL_NETWORK_MTU))
    properties.garden.network_pool: '"((DIEGO_CELL_SUBNET))"'
    properties.garden.no_proxy: '"((NO_PROXY))"'
    properties.garden.privileged_image_plugin: "((^GARDEN_DISABLE_BTRFS))/var/vcap/packages/groot-btrfs/bin/groot-btrfs((/GARDEN_DISABLE_BTRFS))"
    properties.garden.privileged_image_plugin_extra_args: ((^GARDEN_DISABLE_BTRFS))["--config", "/var/vcap/jobs/groot-btrfs/config/groot-btrfs-privileged.yaml"]((/GARDEN_DISABLE_BTRFS))
    properties.grootfs.insecure_docker_registry_list: '[((INSECURE_DOCKER_REGISTRIES))]'
    # How to reach the capi.cc_uploader
    properties.internal_hostname: cc-uploader-cc-uploader.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    properties.locks.locket.hostname: locket-locket.((KUBERNETES_NAMESPACE))
    properties.loggregator.ca_cert: ((INTERNAL_CA_CERT))
    properties.loggregator.cert: ((LOGGREGATOR_CLIENT_CERT))
    properties.loggregator.key: ((LOGGREGATOR_CLIENT_CERT_KEY))
    properties.loggregator.outgoing_cert: ((LOGGREGATOR_OUTGOING_CERT))
    properties.loggregator.outgoing_key: ((LOGGREGATOR_OUTGOING_CERT_KEY))
    properties.loggregator.tls.agent.cert: '"((LOGGREGATOR_AGENT_CERT))"'
    properties.loggregator.tls.agent.key: '"((LOGGREGATOR_AGENT_CERT_KEY))"'
    properties.loggregator.tls.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.loggregator.tls.cc_trafficcontroller.cert: ((TRAFFICCONTROLLER_CERT))
    properties.loggregator.tls.cc_trafficcontroller.key: ((TRAFFICCONTROLLER_CERT_KEY))
    properties.loggregator.tls.doppler.cert: '"((DOPPLER_CERT))"'
    properties.loggregator.tls.doppler.key: '"((DOPPLER_CERT_KEY))"'
    properties.loggregator.tls.reverse_log_proxy.cert: '"((SYSLOG_RLP_CERT))"'
    properties.loggregator.tls.reverse_log_proxy.key: '"((SYSLOG_RLP_CERT_KEY))"'
    properties.loggregator.tls.statsd_injector.cert: '"((CC_SERVER_CRT))"'
    properties.loggregator.tls.statsd_injector.key: '"((CC_SERVER_CRT_KEY))"'
    properties.loggregator.tls.trafficcontroller.cert: '"((TRAFFICCONTROLLER_CERT))"'
    properties.loggregator.tls.trafficcontroller.key: '"((TRAFFICCONTROLLER_CERT_KEY))"'
    properties.loggregator.uaa.client_secret: '"((UAA_CLIENTS_DOPPLER_SECRET))"'
    properties.login.url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))

    # Same-named properties, for the jobs `reverse_log_proxy_gateway`,
    # `log-cache-cf-auth-proxy`, `log-cache-gateway`, `log-cache`, and
    # `loggregator-agent`. All but last are in log-cache release. It
    # is a trial to give them all the same cert, key, and
    # `metrics.server_name` (over in opinions.yml).
    properties.metrics.ca_cert: "((INTERNAL_CA_CERT))"
    properties.metrics.cert: "((METRICS_CERT))"
    properties.metrics.key: "((METRICS_CERT_KEY))"

    # CLUSTER_NAME is not wrapped in quotes because it has quotes in the dev env file.
    properties.name: ((CLUSTER_NAME))
    properties.nats.machines: ((KUBE_NATS_CLUSTER_IPS))
    properties.nats.password: '"((NATS_PASSWORD))"'
    properties.nfsbroker.allowed_options: '"((PERSI_NFS_ALLOWED_OPTIONS))"'
    properties.nfsbroker.db_hostname: *cf-internal-database-host
    properties.nfsbroker.db_password: '"((MYSQL_PERSI_NFS_PASSWORD))"'
    properties.nfsbroker.default_options: '"((PERSI_NFS_DEFAULT_OPTIONS))"'
    properties.nfsbroker.password: '"((PERSI_NFS_BROKER_PASSWORD))"'
    properties.nfsbroker.url: 'http://nfs-broker-nfsbroker.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8999'
    properties.nfsv3driver.allowed-in-mount: '"((PERSI_NFS_DRIVER_ALLOWED_IN_MOUNT))"'
    properties.nfsv3driver.allowed-in-source: '"((PERSI_NFS_DRIVER_ALLOWED_IN_SOURCE))"'
    properties.nfsv3driver.default-in-mount: '"((PERSI_NFS_DRIVER_DEFAULT_IN_MOUNT))"'
    properties.nfsv3driver.default-in-source: '"((PERSI_NFS_DRIVER_DEFAULT_IN_SOURCE))"'
    properties.nfsv3driver.disable: '((PERSI_NFS_DRIVER_DISABLE))'
    properties.nfsv3driver.ldap_host: '"((PERSI_NFS_DRIVER_LDAP_HOST))"'
    properties.nfsv3driver.ldap_port: '"((PERSI_NFS_DRIVER_LDAP_PORT))"'
    properties.nfsv3driver.ldap_proto: '"((PERSI_NFS_DRIVER_LDAP_PROTOCOL))"'
    properties.nfsv3driver.ldap_svc_password: '"((PERSI_NFS_DRIVER_LDAP_PASSWORD))"'
    properties.nfsv3driver.ldap_svc_user: '"((PERSI_NFS_DRIVER_LDAP_USER))"'
    properties.nfsv3driver.ldap_user_fqdn: '"((PERSI_NFS_DRIVER_LDAP_USER_FQDN))"'
    properties.nfsv3driver.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'

    properties.opi.cc_ca: "((INTERNAL_CA_CERT))"
    properties.opi.cc_cert: "((CC_SERVER_CRT))"
    properties.opi.cc_internal_api: "https://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9023"
    properties.opi.cc_key: "((CC_SERVER_CRT_KEY))"
    properties.opi.cc_uploader_ip: "((CC_UPLOADER_CC_UPLOADER_SERVICE_HOST))"
    properties.opi.certs_secret_name: "((KUBE_SECRETS_GENERATION_NAME))"
    properties.opi.client_ca: "((INTERNAL_CA_CERT))"
    properties.opi.downloader_image: "((EIRINI_DOWNLOADER_IMAGE))"
    properties.opi.eirini_address: "https://eirini-opi.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8484"
    properties.opi.executor_image: "((EIRINI_EXECUTOR_IMAGE))"
    properties.opi.kube_namespace: "((EIRINI_KUBE_NAMESPACE))"
    properties.opi.kube_service_host: "((KUBERNETES_SERVICE_HOST))"
    properties.opi.kube_service_port: "((KUBERNETES_SERVICE_PORT))"
    properties.opi.loggregator_address: "doppler-doppler.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8082"
    properties.opi.loggregator_ca: "((INTERNAL_CA_CERT))"
    properties.opi.loggregator_cert: "((DOPPLER_CERT))"
    properties.opi.loggregator_key: "((DOPPLER_CERT_KEY))"
    properties.opi.metrics_source_address: "((EIRINI_KUBE_HEAPSTER_ADDRESS))"
    # TODO: this needs to be fixed upstream - it should be an array
    properties.opi.nats_ip: "nats-0.nats-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"
    properties.opi.nats_password: "((NATS_PASSWORD))"
    properties.opi.registry_address: "127.0.0.1:((OPI_REGISTRY_NODEPORT))"
    properties.opi.registry_password: "((EIRINI_REGISTRY_PASSWORD))"
    properties.opi.registry_username: "((EIRINI_REGISTRY_USERNAME))"
    properties.opi.server_cert: "((EIRINI_SERVER_CERT))"
    properties.opi.server_key: "((EIRINI_SERVER_CERT_KEY))"
    properties.opi.uploader_image: "((EIRINI_UPLOADER_IMAGE))"
    properties.router.balancing_algorithm: '"((ROUTER_BALANCING_ALGORITHM))"'
    properties.router.cipher_suites: "((CIPHER_SUITES))"
    properties.router.client_cert_validation: '"((ROUTER_CLIENT_CERT_VALIDATION))"'
    # We use mysql because it comes up without any other dependencies and its critical for the cluster
    properties.router.dns_health_check_host: 'nats-set.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)).'
    properties.router.force_forwarded_proto_https: ((FORCE_FORWARDED_PROTO_AS_HTTPS))
    properties.router.forwarded_client_cert: "((ROUTER_FORWARDED_CLIENT_CERT))"
    properties.router.logging_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.router.route_services_secret: '"((ROUTER_SERVICES_SECRET))"'
    properties.router.status.password: '"((ROUTER_STATUS_PASSWORD))"'
    properties.router.tls_pem: '((#ROUTER_TLS_PEM))((ROUTER_TLS_PEM))((/ROUTER_TLS_PEM))((^ROUTER_TLS_PEM))[{cert_chain: "((ROUTER_SSL_CERT))", private_key: "((ROUTER_SSL_CERT_KEY))"}]((/ROUTER_TLS_PEM))'
    properties.routing_api.locket.api_location: '"locket-locket.((KUBERNETES_NAMESPACE)):8891"'
    properties.routing_api.locket.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.routing_api.locket.client_cert: '"((DIEGO_CLIENT_CERT))"'
    properties.routing_api.locket.client_key: '"((DIEGO_CLIENT_CERT_KEY))"'
    properties.routing_api.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.routing_api.mtls_ca: '"((INTERNAL_CA_CERT))"'
    properties.routing_api.mtls_client_cert: '"((ROUTING_API_MTLS_CLIENT_CERT))"'
    properties.routing_api.mtls_client_key: '"((ROUTING_API_MTLS_CLIENT_CERT_KEY))"'
    properties.routing_api.mtls_server_cert: '"((ROUTING_API_MTLS_SERVER_CERT))"'
    properties.routing_api.mtls_server_key: '"((ROUTING_API_MTLS_SERVER_CERT_KEY))"'
    properties.routing_api.port: 3000((#KUBERNETES_NAMESPACE))((/KUBERNETES_NAMESPACE))
    properties.routing_api.router_groups: '[{"name":"default-tcp", "type":"tcp", "reservable_ports":"((KUBE_SIZING_TCP_ROUTER_PORTS_TCP_ROUTE_MIN))-((KUBE_SIZING_TCP_ROUTER_PORTS_TCP_ROUTE_MAX))"}]'
    properties.routing_api.sqldb.host: *cf-internal-database-host
    properties.routing_api.sqldb.password: "((MYSQL_ROUTING_API_PASSWORD))"
    properties.routing_api.system_domain: '"((DOMAIN))"'
    properties.routing_api.uri: '"http://routing-api-routing-api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.routing_api.url: '"http://routing-api-routing-api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"'
    properties.scalablesyslog.adapter.logs.addr: '"log-api-reverse-log-proxy.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):8082"'
    properties.scalablesyslog.adapter.tls.ca: '"((INTERNAL_CA_CERT))"'
    properties.scalablesyslog.adapter.tls.cert: '"((SYSLOG_ADAPT_CERT))"'
    properties.scalablesyslog.adapter.tls.key: '"((SYSLOG_ADAPT_CERT_KEY))"'
    properties.scalablesyslog.adapter_rlp.tls.ca: '"((INTERNAL_CA_CERT))"'
    properties.scalablesyslog.adapter_rlp.tls.cert: '"((SYSLOG_ADAPT_CERT))"'
    properties.scalablesyslog.adapter_rlp.tls.key: '"((SYSLOG_ADAPT_CERT_KEY))"'
    properties.scalablesyslog.scheduler.api.url: https://api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN)):9023
    properties.scalablesyslog.scheduler.tls.api.ca: '"((INTERNAL_CA_CERT))"'
    properties.scalablesyslog.scheduler.tls.api.cert: '"((SYSLOG_SCHED_CERT))"'
    properties.scalablesyslog.scheduler.tls.api.key: '"((SYSLOG_SCHED_CERT_KEY))"'
    properties.scalablesyslog.scheduler.tls.client.ca: '"((INTERNAL_CA_CERT))"'
    properties.scalablesyslog.scheduler.tls.client.cert: '"((SYSLOG_SCHED_CERT))"'
    properties.scalablesyslog.scheduler.tls.client.key: '"((SYSLOG_SCHED_CERT_KEY))"'

    properties.scf.eirini.enabled: ((FEATURE_EIRINI_ENABLED))

    properties.scf.internal-ca-cert: '"((INTERNAL_CA_CERT))"'
    properties.scf.secrets_generation_name: "((KUBE_SECRETS_GENERATION_NAME))"
    properties.scf.uaa.internal-url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))
    properties.scf.uaa.root-zone.url: https://((UAA_HOST)):((UAA_PORT))
    properties.scf_set_proxy.running_http_proxy: '"((HTTP_PROXY))"'
    properties.scf_set_proxy.running_https_proxy: '"((HTTPS_PROXY))"'
    properties.scf_set_proxy.running_no_proxy: '"((NO_PROXY))"'
    properties.scf_set_proxy.staging_http_proxy: '"((HTTP_PROXY))"'
    properties.scf_set_proxy.staging_https_proxy: '"((HTTPS_PROXY))"'
    properties.scf_set_proxy.staging_no_proxy: '"((NO_PROXY))"'
    properties.sle15-rootfs.trusted_certs: '"((ROOTFS_TRUSTED_CERTS))((#ROOTFS_TRUSTED_CERTS))\n((/ROOTFS_TRUSTED_CERTS))((INTERNAL_CA_CERT))"'
    properties.smoke_tests.api: '"api.((DOMAIN))"'
    properties.smoke_tests.apps_domain: '["((DOMAIN))"]'
    properties.smoke_tests.autoscaler_endpoint: '"https://autoscaler.((DOMAIN))"'
    properties.smoke_tests.password: '"((CLUSTER_ADMIN_PASSWORD))"'
    properties.support_address: '"((SUPPORT_ADDRESS))"'
    properties.system_domain: '"((DOMAIN))"'
    properties.tcp_router.log_level: '"((GO_LOG_LEVEL))((#LOG_LEVEL))((/LOG_LEVEL))"'
    properties.tcp_router.oauth_secret: '"((UAA_CLIENTS_TCP_ROUTER_SECRET))"'
    properties.tls.ca_cert: '"((INTERNAL_CA_CERT))"'
    properties.tls.cert: '"((DIEGO_CLIENT_CERT))"'
    properties.tls.key: '"((DIEGO_CLIENT_CERT_KEY))"'
    properties.uaa.admin.client_secret: '"((UAA_ADMIN_CLIENT_SECRET))"'
    properties.uaa.ca_cert: '"((UAA_CA_CERT))"'
    properties.uaa.client_secret: '"((UAA_CLIENTS_TCP_EMITTER_SECRET))"'
    properties.uaa.clients.app_autoscaler.secret: ((AUTOSCALER_UAA_CLIENT_SECRET))
    properties.uaa.clients.cc-service-dashboards.secret: '"((UAA_CLIENTS_CC_SERVICE_DASHBOARDS_CLIENT_SECRET))"'
    properties.uaa.clients.cc_routing.secret: '"((UAA_CLIENTS_CC_ROUTING_SECRET))"'
    properties.uaa.clients.cc_service_key_client.secret: '"((UAA_CLIENTS_CC_SERVICE_KEY_CLIENT_SECRET))"'
    properties.uaa.clients.cf-usb.secret: '"((UAA_CLIENTS_CF_USB_SECRET))"'
    properties.uaa.clients.cf.redirect-uri: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))/login
    properties.uaa.clients.cf_smoke_tests.secret: ((UAA_CLIENTS_CF_SMOKE_TESTS_CLIENT_SECRET))
    properties.uaa.clients.cloud_controller_username_lookup.secret: '"((UAA_CLIENTS_CLOUD_CONTROLLER_USERNAME_LOOKUP_SECRET))"'
    properties.uaa.clients.credhub_user_cli.secret: '"((UAA_CLIENTS_CREDHUB_USER_CLI_SECRET))"'
    properties.uaa.clients.default_zone_admin.secret: '"((UAA_ADMIN_CLIENT_SECRET))"'
    properties.uaa.clients.doppler.redirect-uri: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))
    properties.uaa.clients.doppler.secret: '"((UAA_CLIENTS_DOPPLER_SECRET))"'
    properties.uaa.clients.gorouter.secret: '"((UAA_CLIENTS_GOROUTER_SECRET))"'
    properties.uaa.clients.routing_api_client.secret: ((UAA_CLIENTS_ROUTING_API_CLIENT_SECRET))
    properties.uaa.clients.scf_auto_config.secret: '"((UAA_CLIENTS_SCF_AUTO_CONFIG_SECRET))"'
    properties.uaa.clients.ssh-proxy.redirect-uri: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))/login
    properties.uaa.clients.ssh-proxy.secret: '"((UAA_CLIENTS_DIEGO_SSH_PROXY_SECRET))"'
    properties.uaa.clients.tcp_emitter.secret: '"((UAA_CLIENTS_TCP_EMITTER_SECRET))"'
    properties.uaa.clients.tcp_router.secret: '"((UAA_CLIENTS_TCP_ROUTER_SECRET))"'
    properties.uaa.internal_url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT)) # For loggregator
    properties.uaa.scim.users: '[{name: admin, password: ((CLUSTER_ADMIN_PASSWORD)), groups: [((CLUSTER_ADMIN_AUTHORITIES))]}]'
    properties.uaa.ssl.port: ((UAA_PORT))
    properties.uaa.tls_port: ((UAA_PORT))
    properties.uaa.token_endpoint: ((KUBERNETES_NAMESPACE)).((UAA_HOST))
    properties.uaa.url: https://((KUBERNETES_NAMESPACE)).((UAA_HOST)):((UAA_PORT))
    properties.version: '"((CLUSTER_VERSION))"'
    # Really a loggregator_agent job property
    properties.zone: '"((KUBE_AZ))"'
variables:
- name: ACCEPTANCE_TEST_FLAKE_ATTEMPTS
  options:
    default: 3
    description: >
      The number of times Ginkgo will run a CATS test before treating it as a failure.
      Individual failed runs will still be reported in the test output.
- name: ACCEPTANCE_TEST_NODES
  options:
    default: 4
    description: >
      The number of parallel test executors to spawn for Cloud Foundry
      acceptance tests. The larger the number the higher the stress on the system.
- name: AEK_PASSWORD
  options:
    secret: true
    immutable: true
    description: Password used for the active uaa encryption key.
  type: password
- name: ALLOWED_CORS_DOMAINS
  options:
    default: []
    description: List of domains (including scheme) from which Cross-Origin requests
      will be accepted, a * can be used as a wildcard for any part of a domain.
    required: true
- name: ALLOW_APP_SSH_ACCESS
  options:
    default: true
    description: Allow users to change the value of the app-level allow_ssh attribute.
    required: true
- name: APP_SSH_KEY
  options:
    secret: true
    description: PEM encoded RSA private key used to identify host.
    required: true
  type: ssh
- name: APP_SSH_KEY_FINGERPRINT
  options:
    secret: true
    description: MD5 fingerprint of the host key of the SSH proxy that brokers connections
      to application instances.
    required: true
- name: APP_TOKEN_UPLOAD_GRACE_PERIOD
  options:
    default: 1200
    description: Extra token expiry time while uploading big apps, in seconds.
    required: true
- name: AUCTIONEER_REP_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: AUCTIONEER_REP_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key
    required: true
- name: AUCTIONEER_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: diego-brain-auctioneer
    description: PEM-encoded server certificate
    required: true
  type: certificate
- name: AUCTIONEER_SERVER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded server key
    required: true
- name: AUTOSCALER_ASAPI_PUBLIC_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - autoscaler.{{.DOMAIN}}
    - localhost
    description: A PEM-encoded TLS certificate of the Autoscaler API public https
      server. This includes the Autoscaler ApiServer and the Service Broker.
    required: true
  type: certificate
- name: AUTOSCALER_ASAPI_PUBLIC_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key of the Autoscaler API public https server.
      This includes the Autoscaler ApiServer and the Service Broker.
    required: true
- name: AUTOSCALER_ASAPI_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - autoscaler-api-apiserver.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}
    - localhost
    description: A PEM-encoded TLS certificate of the Autoscaler API https server.
      This includes the Autoscaler ApiServer and the Service Broker.
    required: true
  type: certificate
- name: AUTOSCALER_ASAPI_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key of the Autoscaler API https server. This includes
      the Autoscaler ApiServer and the Service Broker.
    required: true
- name: AUTOSCALER_ASMETRICS_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: A PEM-encoded TLS certificate for clients to connect to the Autoscaler
      Metrics. This includes the Autoscaler Metrics Collector and Event Generator.
    required: true
  type: certificate
- name: AUTOSCALER_ASMETRICS_CLIENT_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for clients to connect to the Autoscaler Metrics.
      This includes the Autoscaler Metrics Collector and Event Generator.
    required: true
- name: AUTOSCALER_ASMETRICS_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - autoscaler-metrics-metricscollector.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}
    - autoscaler-metrics-eventgenerator.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}
    - localhost
    description: A PEM-encoded TLS certificate of the Autoscaler Metrics https server.
      This includes the Autoscaler Metrics Collector.
    required: true
  type: certificate
- name: AUTOSCALER_ASMETRICS_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key of the Autoscaler Metrics https server. This
      includes the Autoscaler Metrics Collector.
    required: true
- name: AUTOSCALER_DB_ADDRESS
  options:
    default: "autoscaler-postgres-postgres.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))"
    description: The db address for the Autoscaler postgres database.
- name: AUTOSCALER_DB_PASSWORD
  options:
    secret: true
    description: The password for the Autoscaler postgres database.
    required: true
  type: password
- name: AUTOSCALER_DB_PORT
  options:
    default: 5432
    description: "The tcp port of postgres database serves on"
- name: AUTOSCALER_DB_ROLE_NAME
  options:
    default: "postgres"
    description: "The role name of autoscaler postgres database"
- name: AUTOSCALER_SCALING_ENGINE_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: A PEM-encoded TLS certificate for clients to connect to the Autoscaler Scaling Engine.
    required: true
  type: certificate
- name: AUTOSCALER_SCALING_ENGINE_CLIENT_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for clients to connect to the Autoscaler Scaling Engine.
    required: true
- name: AUTOSCALER_SCALING_ENGINE_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - autoscaler-actors-scalingengine.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}
    - localhost
    description: A PEM-encoded TLS certificate of the Autoscaler Scaling Engine https server.
    required: true
  type: certificate
- name: AUTOSCALER_SCALING_ENGINE_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key of the Autoscaler Scaling Engine https server.
    required: true
- name: AUTOSCALER_SCHEDULER_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: A PEM-encoded TLS certificate for clients to connect to the Autoscaler Scheduler.
    required: true
  type: certificate
- name: AUTOSCALER_SCHEDULER_CLIENT_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for clients to connect to the Autoscaler Scheduler.
    required: true
- name: AUTOSCALER_SCHEDULER_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - autoscaler-actors-scheduler.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}
    - localhost
    description: A PEM-encoded TLS certificate of the Autoscaler Scheduler https server.
    required: true
  type: certificate
- name: AUTOSCALER_SCHEDULER_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key of the Autoscaler Scheduler https server.
    required: true
- name: AUTOSCALER_UAA_CLIENT_SECRET
  options:
    secret: true
    description: the uaa client secret used by Autoscaler.
  type: password
- name: AZ_LABEL_NAME
  options:
    default: 'failure-domain.beta.kubernetes.io/zone'
    description: The name of the metadata label to query on worker nodes to get AZ information.
    internal: true
- name: BBS_ACTIVE_KEY_PASSPHRASE
  options:
    secret: true
    immutable: true
    description: The password for access to the diego BBS database.
    required: true
  type: password
- name: BBS_AUCTIONEER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: BBS_AUCTIONEER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key
    required: true
- name: BBS_CLIENT_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded client certificate.
    required: true
  type: certificate
- name: BBS_CLIENT_CRT_KEY
  options:
    secret: true
    description: PEM-encoded client key.
    required: true
- name: BBS_REP_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: BBS_REP_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key
    required: true
- name: BBS_SERVER_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: diego-api-bbs
    description: PEM-encoded client certificate.
    required: true
  type: certificate
- name: BBS_SERVER_CRT_KEY
  options:
    secret: true
    description: PEM-encoded client key.
    required: true
- name: BITS_SERVICE_SECRET
  options:
    secret: true
    description: This is the key secret Bits-Service uses and clients should use to generate signed URLs.
    required: true
  type: password
- name: BITS_SERVICE_SSL_CERT
  options:
    secret: true
    ca: '{{if eq .FEATURE_EIRINI_ENABLED "true"}}~{{else}}INTERNAL_CA_CERT{{end}}'
    description: PEM-encoded client certificate.
    required: true
    alternative_names:
    - 127.0.0.1
  type: certificate
- name: BITS_SERVICE_SSL_CERT_KEY
  options:
    secret: true
    description: PEM-encoded client key.
    required: true

- name: BLOBSTORE_ACCESS_RULES
  options:
    default: allow 10.0.0.0/8; allow 172.16.0.0/12; allow 192.168.0.0/16;
    description: List of allow / deny rules for the blobstore internal server. Will
      be followed by 'deny all'. Each entry must be follow by a semicolon.
    required: true
- name: BLOBSTORE_MAX_UPLOAD_SIZE
  options:
    default: 5000
    description: Maximal allowed file size for upload to blobstore, in megabytes.
    required: true
- name: BLOBSTORE_PASSWORD
  options:
    secret: true
    description: The basic auth password that Cloud Controller uses to connect to
      the blobstore server. Auto-generated if not provided. Passwords must be alphanumeric
      (URL-safe).
    required: true
  type: password
- name: BLOBSTORE_SECURE_LINK
  options:
    secret: true
    description: The secret used for signing URLs between Cloud Controller and blobstore.
    required: true
  type: password
- name: BLOBSTORE_TLS_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: blobstore-blobstore
    description: The PEM-encoded certificate (optionally as a certificate chain) for
      serving blobs over TLS/SSL.
    required: true
  type: certificate
- name: BLOBSTORE_TLS_CERT_KEY
  options:
    secret: true
    description: The PEM-encoded private key for signing TLS/SSL traffic.
    required: true
- name: BROKER_CLIENT_TIMEOUT_SECONDS
  options:
    default: '70'
    description: For requests to service brokers, this is the HTTP (open and read)
      timeout setting, in seconds.
- name: BULK_API_PASSWORD
  options:
    secret: true
    description: The password for the bulk api.
    required: true
  type: password
- name: CATS_SUITES
  options:
    internal: true
    description: The set of CAT test suites to run. If not specified it falls back
      to a hardwired set of suites.
- name: CC_DB_CURRENT_KEY_LABEL
  options:
    description: The key used to encrypt entries in the CC database
    default: ''
- name: CC_DB_ENCRYPTION_KEYS
  options:
    description: A map of labels and encryption keys
    secret: true
    default: "~"
- name: CC_PUBLIC_TLS_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "api"
    - "api-set"
    - "api-set.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    - "api.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    description: The PEM-encoded certificate for secure TLS communication over external endpoints.
    required: true
  type: certificate
- name: CC_PUBLIC_TLS_CERT_KEY
  options:
    secret: true
    description: The PEM-encoded key for secure TLS communication over external endpoints.
    required: true
- name: CC_SERVER_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: api
    description: The PEM-encoded certificate for internal cloud controller traffic.
    required: true
  type: certificate
- name: CC_SERVER_CRT_KEY
  options:
    secret: true
    description: The PEM-encoded private key for internal cloud controller traffic.
    required: true
- name: CC_UPLOADER_CC_UPLOADER_SERVICE_HOST
  options:
    type: environment
    description: IP of the cc uploader service. This is automatically set by Kubernetes.
      traffic.
- name: CC_UPLOADER_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: cc-uploader-cc-uploader
    description: The PEM-encoded certificate for internal cloud controller uploader
      traffic.
    required: true
  type: certificate
- name: CC_UPLOADER_CRT_KEY
  options:
    secret: true
    description: The PEM-encoded private key for internal cloud controller uploader
      traffic.
    required: true
- name: CDN_URI
  options:
    default: ''
    description: URI for a CDN to use for buildpack downloads.
- name: CERT_EXPIRATION
  options:
    description: Expiration for generated certificates (in days)
    default: 10950
- name: CF_USB_BROKER_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: cf-usb
    description: PEM-encoded broker server certificate.
  type: certificate
- name: CF_USB_BROKER_SERVER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded broker server key.
- name: CF_USB_PASSWORD
  options:
    secret: true
    example: password
    description: The password for access to the Universal Service Broker.
  type: password
- name: CIPHER_SUITES
  options:
    description: An ordered, colon-delimited list of golang supported TLS cipher suites in OpenSSL or RFC format.
    default: ECDHE-ECDSA-CHACHA20-POLY1305:TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305:ECDHE-RSA-CHACHA20-POLY1305:TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384:ECDHE-RSA-AES256-GCM-SHA384:TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384:AES128-GCM-SHA256:AES256-GCM-SHA384
- name: CLUSTER_ADMIN_AUTHORITIES
  options:
    default: scim.write,scim.read,openid,cloud_controller.admin,clients.read,clients.write,doppler.firehose,routing.router_groups.read,routing.router_groups.write
    description: The Oauth2 authorities available to the cluster administrator.
    required: true
- name: CLUSTER_ADMIN_PASSWORD
  options:
    secret: true
    description: The password for the cluster administrator.
    required: true
- name: CLUSTER_BUILD
  options:
    default: 2.16.4
    description: "'build' attribute in the /v2/info endpoint"
    required: true
- name: CLUSTER_DESCRIPTION
  options:
    default: SUSE Cloud Foundry
    description: "'description' attribute in the /v2/info endpoint"
    required: true
- name: CLUSTER_NAME
  options:
    default: SCF
    description: "'name' attribute in the /v2/info endpoint"
    required: true
- name: CLUSTER_VERSION
  options:
    default: 2
    description: "'version' attribute in the /v2/info endpoint"
    required: true
- name: CREDHUB_ENCRYPT_KEY
  options:
    secret: true
    immutable: true
    description: Credhub encryption key
    required: true
  type: password
- name: CREDHUB_LOG_LEVEL
  options:
    description: >
      The log level for credhub. This parameter is not supposed to be set
      by the user. To change the cluster's log level set the parameter
      `LOG_LEVEL` instead, from which this one is derived.
    type: environment
- name: CREDHUB_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "credhub-set"
    - "server.dc1.{{.KUBERNETES_NAMESPACE}}.svc.{{.KUBERNETES_CLUSTER_DOMAIN}}"
    description: PEM-encoded server certificate
    required: true
  type: certificate
- name: CREDHUB_SERVER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded server key
    required: true
- name: DB_ENCRYPTION_KEY
  options:
    secret: true
    immutable: true
    description: Key for encrypting sensitive values in the Cloud Controller database.
    required: true
  type: password
- name: DB_EXTERNAL_DRIVER
  options:
    immutable: true
    description: >
      Database driver to use for the external database server used to manage the
      CF-internal databases.  Only used if DB_EXTERNAL_HOST is set.  Currently
      only `mysql` is valid.
    default: mysql
- name: DB_EXTERNAL_HOST
  options:
    immutable: true
    description: >
      Hostname for an external database server to use for the CF-internal databases
      (such as for the cloud controller database).  If not set, the internal database
      is used.
    default: null
- name: DB_EXTERNAL_PASSWORD
  options:
    immutable: true
    description: >
      Administrator password for an external database server; this is required
      to create the necessary databases.  Only used if DB_EXTERNAL_HOST is set.
    secret: true
- name: DB_EXTERNAL_PORT
  options:
    immutable: true
    description: >
      Port for an external database server to use for the CF-internal databases.
      Only used if DB_EXTERNAL_HOST is set.
    default: "3306"
- name: DB_EXTERNAL_SSL_MODE
  options:
    immutable: true
    description: >
      TLS configuration for the external database server to use for the
      CF-internal databases.  Only used if DB_EXTERNAL_HOST is set.  Valid
      values depend on which database driver is in use.
- name: DB_EXTERNAL_USER
  options:
    immutable: true
    description: >
      Administrator user name for an external database server; this is required
      to create the necessary databases.  Only used if DB_EXTERNAL_HOST is set.
- name: DEFAULT_APP_DISK_IN_MB
  options:
    default: 1024
    description: The standard amount of disk (in MB) given to an application when
      not overriden by the user via manifest, command line, etc.
    required: true
- name: DEFAULT_APP_MEMORY
  options:
    default: 1024
    description: The standard amount of memory (in MB) given to an application when
      not overriden by the user via manifest, command line, etc.
    required: true
- name: DEFAULT_APP_SSH_ACCESS
  options:
    default: true
    description: If set apps pushed to spaces that allow SSH access will have SSH
      enabled by default.
    required: true
- name: DEFAULT_STACK
  options:
    default: sle15
    description: The default stack to use if no custom stack is specified by an app.
- name: DIEGO_CELL_DISK_CAPACITY_MB
  options:
    default: auto
    description: The container disk capacity the cell should manage. If this capacity
      is larger than the actual disk quota of the cell component, over-provisioning
      will occur.
    required: true
- name: DIEGO_CELL_MEMORY_CAPACITY_MB
  options:
    default: auto
    description: The memory capacity the cell should manage. If this capacity is larger
      than the actual memory of the cell component, over-provisioning will occur.
    required: true
- name: DIEGO_CELL_NETWORK_MTU
  options:
    default: '1400'
    description: Maximum network transmission unit length in bytes for application
      containers.
    required: true
- name: DIEGO_CELL_SUBNET
  options:
    default: 10.38.0.0/16
    description: A CIDR subnet mask specifying the range of subnets available to be
      assigned to containers.
    required: true
- name: DIEGO_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - locket-locket.{{.KUBERNETES_NAMESPACE}}
    - 127.0.0.1
    description: PEM-encoded client certificate
    required: true
  type: certificate
- name: DIEGO_CLIENT_CERT_KEY
  options:
    secret: true
    description: PEM-encoded client key
    required: true
- name: DISABLE_CUSTOM_BUILDPACKS
  options:
    default: false
    description: Disable external buildpacks. Only admin buildpacks and system buildpacks
      will be available to users.
    required: true
- name: DOMAIN
  options:
    example: my-scf-cluster.com
    required: true
    description: Base domain of the SCF cluster.
- name: DOPPLER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - doppler
    - log-cache
    - metron
    description: PEM-encoded certificate.
    required: true
  type: certificate
- name: DOPPLER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: DROPLET_MAX_STAGED_STORED
  options:
    default: 5
    description: The number of versions of an application to keep. You will be able
      to rollback to this amount of versions.
    required: true
- name: EIRINI_CLIENT_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: TLS certificate for Eirini server
    required: true
  type: certificate
- name: EIRINI_CLIENT_CRT_KEY
  options:
    secret: true
    description: Private key associated with TLS certificate for Eirini server
    required: true
- name: EIRINI_DOWNLOADER_IMAGE
  options:
    default: 'registry.suse.com/cap-staging/recipe-downloader:0.30.0'
    description: "Downloads app-bits and buildpacks from the bits-service"
    imagename: true
- name: EIRINI_EXECUTOR_IMAGE
  options:
    default: 'registry.suse.com/cap-staging/recipe-executor:0.31.0'
    description: "Executes the buildpackapplifecyle to build a Droplet"
    imagename: true
- name: EIRINI_KUBE_HEAPSTER_ADDRESS
  options:
    default: 'http://heapster.kube-system/apis/metrics/v1alpha1'
    description: "Address of Kubernetes' Heapster installation, used for reading Cloud Foundry app metrics."
- name: EIRINI_KUBE_NAMESPACE
  options:
    default: 'eirini'
    description: "The namespace used by Eirini for deploying applications."
- name: EIRINI_PERSI_NFS_BROKER_PASSWORD
  options:
    description: Basic auth password to verify on incoming Service Broker requests
    secret: true
    required: true
  type: password
- name: EIRINI_PERSI_PLANS
  options:
    description: "Array of plans that the Eirini persi broker will expose to Cloud Foundry."
    default: '[]'
    example: |
      - id: "default-storageclass"
        name: "default"
        description: "Eirini persistence broker"
        free: true
        kube_storage_class: "persistent"
        default_size: "1Gi"

- name: EIRINI_REGISTRY_PASSWORD
  options:
    secret: true
    description: "Basic auth user password for registry"
    required: true
  type: password
- name: EIRINI_REGISTRY_USERNAME
  options:
    type: environment
    default: 'admin'
    description: "Basic auth username for registry"
- name: EIRINI_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "eirini-opi.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    description: TLS certificate for Eirini server
    required: true
  type: certificate
- name: EIRINI_SERVER_CERT_KEY
  options:
    secret: true
    description: Private key associated with TLS certificate for Eirini server
    required: true
- name: EIRINI_SSH_PORT
  options:
    default: '2222'
    description: "The port of the ssh proxy for Eirini"
- name: EIRINI_UPLOADER_IMAGE
  options:
    default: 'registry.suse.com/cap-staging/recipe-uploader:0.28.0'
    description: "Uploads the Droplet to the bits-service"
    imagename: true
- name: ENABLE_SECURITY_EVENT_LOGGING
  options:
    default: 'false'
    description: "By default, Cloud Foundry does not enable Cloud Controller request
      logging. To enable this feature, you must set this property to \"true\". You
      can learn more about the format of the logs here https://docs.cloudfoundry.org/loggregator/cc-uaa-logging.html#cc
      \n"
- name: FEATURE_EIRINI_ENABLED
  options:
    type: environment
    default: 'false'
    description: "Whether to enable the Eirini component, which deploys applications on Kubernetes. This causes Diego to be disabled."
- name: FILE_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: diego-access
    description: PEM-encoded tls certificate that can be used for server auth.
    required: true
  type: certificate
- name: FILE_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for the file server.
    required: true
- name: FORCE_FORWARDED_PROTO_AS_HTTPS
  options:
    default: false
    description: Enables setting the X-Forwarded-Proto header if SSL termination happened
      upstream and the header value was set incorrectly. When this property is set
      to true, the gorouter sets the header X-Forwarded-Proto to https. When this
      value set to false, the gorouter sets the header X-Forwarded-Proto to the protocol
      of the incoming request.
    required: true
- name: GALERA_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - galera_server_certificate
    description: A PEM-encoded TLS certificate for the Galera server.
    required: true
  type: certificate
- name: GALERA_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for the Galera server.
    required: true
- name: GARDEN_APPARMOR_PROFILE
  options:
    default: garden-default
    description: AppArmor profile name for garden-runc; set this to empty string to
      disable AppArmor support
- name: GARDEN_DISABLE_BTRFS
  options:
    default: ''
    description: An empty value means BTRFS is used. It's set to "true" by a script
      if GARDEN_ROOTFS_DRIVER is set to overlay-xfs.
    type: environment
- name: GARDEN_DOCKER_REGISTRY
  options:
    default: registry-1.docker.io
    description: URL pointing to the Docker registry used for fetching Docker images.
      If not set, the Docker service default is used.
    required: true
- name: GARDEN_LINUX_DNS_SERVER
  options:
    default: ''
    description: Override DNS servers to be used in containers; defaults to the same
      as the host.
- name: GARDEN_ROOTFS_DRIVER
  options:
    default: btrfs
    description: The filesystem driver to use (btrfs or overlay-xfs).
    required: true
    internal: true
- name: GO_LOG_LEVEL
  options:
    type: environment
    description: The log level for go components. This parameter is not supposed
      to be set by the user. To change the cluster's log level set the parameter
      `LOG_LEVEL` instead, from which this one is derived.
- name: HELM_IS_INSTALL
  options:
    type: environment
    description: >
      This is an environment variable built-in by fissile.
      It's set directly from the Release.IsInstall Helm property.
- name: HOSTNAME
  options:
    description: The host name of the container.  This should be automatic and should
      not be prompted.
    type: environment
- name: HTTPS_PROXY
  options:
    required: false
    description: Location of the proxy to use for secure web access.
- name: HTTP_PROXY
  options:
    required: false
    description: Location of the proxy to use for regular web access.
- name: INSECURE_DOCKER_REGISTRIES
  options:
    default: ''
    example: '"docker-registry.example.com:80", "hello.example.org:443"'
    description: >
      A comma-separated whitelist of insecure Docker registries in the
      form of '<HOSTNAME|IP>:PORT'. Each registry must be quoted separately.
- name: INTERNAL_API_PASSWORD
  options:
    secret: true
    description: Basic auth password for access to the Cloud Controller's internal
      API.
    required: true
  type: password
- name: INTERNAL_CA_CERT
  options:
    secret: true
    is_ca: true
    append_kube_ca: '{{.FEATURE_EIRINI_ENABLED}}'
    description: PEM-encoded CA certificate used to sign the TLS certificate used
      by all components to secure their communications.
    required: true
  type: certificate
- name: INTERNAL_CA_CERT_KEY
  options:
    secret: true
    description: PEM-encoded CA key.
    required: true
- name: JWT_SIGNING_CERT
  options:
    secret: true
    is_ca: true
    description: PEM-encoded JWT certificate.
    required: true
  type: certificate
- name: JWT_SIGNING_CERT_KEY
  options:
    secret: true
    description: PEM-encoded JWT signing key.
    required: true
- name: KUBERNETES_CLUSTER_DOMAIN
  options:
    type: environment
    description: >
      The cluster domain used by Kubernetes.
      If left empty, each container will try to determine the correct value based on /etc/resolv.conf
      You can read more about it in the Kubernetes Documentation https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/
- name: KUBERNETES_NAMESPACE
  options:
    type: environment
    description: The name of the kubernetes namespace all components will run in.
      This parameter cannot be set by the user. Its value is supplied by the kubernetes
      runtime.
- name: KUBERNETES_SERVICE_HOST
  options:
    type: environment
    description: >
      This is an environment variable set by Kubernetes.
      We have to pass it through the templating mechanism, because monit doesn't keep the entrypoint's environment.
- name: KUBERNETES_SERVICE_PORT
  options:
    type: environment
    description: >
      This is an environment variable set by Kubernetes.
      We have to pass it through the templating mechanism, because monit doesn't keep the entrypoint's environment.


- name: KUBERNETES_STORAGE_CLASS_PERSISTENT
  options:
    type: environment
    description: >
      Storage class used for SCF acceptance tests.
- name: KUBE_AZ
  options:
    type: environment
    default: z1
    description: >
      A string representing the availability zone a container is running in.
      Shouldn't be changed from its default value of z1.
- name: KUBE_COMPONENT_INDEX
  options:
    type: environment
    description: >
      This is an environment variable built-in by fissile.
      It's set to a numeric index for roles with multiple replicas.
- name: KUBE_CSR_AUTO_APPROVAL
  options:
    default: false
    description: >
      Allow the secrets-generator to auto-approve the kube cert signing requests it makes.
- name: KUBE_NATS_CLUSTER_IPS
  options:
    type: environment
    description: A comma-separated list of IP addresses for the machines of the nats
      sub-cluster. This parameter cannot be set by the user. Its value is automatically
      computed during cluster setup.
- name: KUBE_PZ
  options:
    type: environment
    default: ''
    description: >
      A string representing the placement tag a container is running in.
- name: KUBE_SECRETS_GENERATION_COUNTER
  options:
    type: environment
    description: >
      This is an environment variable built-in by fissile.
      It's automatically set to the kube.secrets_generation_counter Helm value, which controls secret rotation.
- name: KUBE_SECRETS_GENERATION_NAME
  options:
    type: environment
    description: >
      This is an environment variable built-in by fissile.
      Its default value is 'secret-1' and cannot be set by the user.
- name: KUBE_SIZING_NATS_COUNT
  options:
    description: The number of nats replicas deployed. This value is set automatically
      by the helm charts of SCF.
- name: KUBE_SIZING_TCP_ROUTER_PORTS_TCP_ROUTE_MAX
  options:
    description: Highest internal TCP routing port. This value is set automatically
      by the helm charts of SCF.
- name: KUBE_SIZING_TCP_ROUTER_PORTS_TCP_ROUTE_MIN
  options:
    description: Lowest internal TCP routing port. This value is set automatically
      by the helm charts of SCF.
- name: LOGGREGATOR_AGENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - localhost
    - metron
    description: PEM-encoded certificate.
    required: true
  type: certificate
- name: LOGGREGATOR_AGENT_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: LOGGREGATOR_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded client certificate for loggregator mutual authentication
    required: true
  type: certificate
- name: LOGGREGATOR_CLIENT_CERT_KEY
  options:
    secret: true
    description: PEM-encoded client key for loggregator mutual authentication
    required: true
- name: LOGGREGATOR_FORWARD_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded client certificate for loggregator forwarder authentication
    required: true
  type: certificate
- name: LOGGREGATOR_FORWARD_CERT_KEY
  options:
    secret: true
    description: PEM-encoded client key for loggregator forwarder authentication
    required: true
- name: LOGGREGATOR_OUTGOING_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "doppler"
    - "log-api-loggregator-trafficcontroller.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    description: TLS cert for outgoing dropsonde connection
    required: true
  type: certificate
- name: LOGGREGATOR_OUTGOING_CERT_KEY
  options:
    secret: true
    description: TLS key for outgoing dropsonde connection
    required: true
- name: LOG_CACHE_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - log-cache
    - localhost
    description: PEM-encoded certificate.
    required: true
  type: certificate
- name: LOG_CACHE_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: LOG_CACHE_CF_AUTH_PROXY_EXTERNAL_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - log-cache
    - localhost
    description: The TLS cert for the auth proxy.
    required: true
  type: certificate
- name: LOG_CACHE_CF_AUTH_PROXY_EXTERNAL_CERT_KEY
  options:
    secret: true
    description: The TLS key for the auth proxy.
    required: true
- name: LOG_CACHE_GATEWAY_PROXY_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - log-cache
    - localhost
    description: PEM-encoded certificate.
    required: true
  type: certificate
- name: LOG_CACHE_GATEWAY_PROXY_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: LOG_LEVEL
  options:
    default: info
    description: >
      The cluster's log level: off, fatal, error, warn, info, debug, debug1, debug2.
    required: true
- name: LOG_LEVEL_LOG4J
  options:
    type: environment
    description: 'The log level for Log4j-using components.  This parameter is not
      supposed to be set by the user.  To change the cluster''s log level set the
      parameter `LOG_LEVEL` above instead, from which this one is derived.'
- name: MAX_APP_DISK_IN_MB
  options:
    default: 2048
    description: The maximum amount of disk a user can request for an application
      via manifest, command line, etc., in MB. See also DEFAULT_APP_DISK_IN_MB for
      the standard amount.
    required: true
- name: MAX_HEALTH_CHECK_TIMEOUT
  options:
    default: 180
    description: Maximum health check timeout that can be set for an app, in seconds.
    required: true

- name: METRICS_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - metrics_server
    - localhost
    description: PEM-encoded certificate.
    required: true
  type: certificate
- name: METRICS_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true

- name: MONIT_PASSWORD
  options:
    secret: true
    description: Password used for the monit API.
    required: true
  type: password
- name: MYSQL_ADMIN_PASSWORD
  options:
    secret: true
    description: The password for the MySQL server admin user.
    required: true
  type: password
- name: MYSQL_CCDB_ROLE_PASSWORD
  options:
    previous_names:
    - CCDB_ROLE_PASSWORD
    secret: true
    description: The password for access to the Cloud Controller database.
    required: true
  type: password
- name: MYSQL_CF_USB_PASSWORD
  options:
    secret: true
    example: password
    description: The password for access to the usb config database.
  type: password
- name: MYSQL_CLUSTER_HEALTH_PASSWORD
  options:
    secret: true
    description: The password for the cluster logger health user.
    required: true
  type: password
- name: MYSQL_CREDHUB_USER_PASSWORD
  options:
    secret: true
    description: The password for access to the credhub-user database.
    required: true
  type: password
- name: MYSQL_DIEGO_LOCKET_PASSWORD
  options:
    description: Database password for the diego locket service.
    secret: true
    required: true
  type: password
- name: MYSQL_DIEGO_PASSWORD
  options:
    secret: true
    description: The password for access to MySQL by diego.
    required: true
  type: password
- name: MYSQL_GALERA_HEALTHCHECK_ENDPOINT_PASSWORD
  options:
    secret: true
    description: Password used to authenticate to the MySQL Galera healthcheck endpoint.
    required: true
  type: password
- name: MYSQL_PERSI_NFS_PASSWORD
  options:
    description: Database password for storing broker state for the Persi NFS Broker
    secret: true
    required: true
  type: password
- name: MYSQL_PROXY_ADMIN_PASSWORD
  options:
    secret: true
    description: The password for Basic Auth used to secure the MySQL proxy API.
    required: true
  type: password
- name: MYSQL_ROUTING_API_PASSWORD
  options:
    secret: true
    description: The password for access to MySQL by the routing-api
    required: true
  type: password
- name: MYSQL_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "mysql-set.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    - "mysql-proxy-set.{{ .KUBERNETES_NAMESPACE }}.svc.{{ .KUBERNETES_CLUSTER_DOMAIN }}"
    description: A PEM-encoded TLS certificate for the MySQL server.
    required: true
  type: certificate
- name: MYSQL_SERVER_CERT_KEY
  options:
    secret: true
    description: A PEM-encoded TLS key for the MySQL server.
    required: true
- name: NATS_PASSWORD
  options:
    secret: true
    description: The password for access to NATS.
    required: true
  type: password
- name: NGINX_LOG_LEVEL
  options:
    type: environment
    description: The log level for nginx. This parameter is not supposed to be set
      by the user. To change the cluster's log level set the parameter `LOG_LEVEL`
      instead, from which this one is derived.
- name: NGINX_MAX_REQUEST_BODY_SIZE
  options:
    default: 2048
    description: Sets the maximum allowed size of the client request body, specified
      in the Content-Length request header field, in megabytes. If the size in a
      request exceeds the configured value, the 413 (Request Entity Too Large) error
      is returned to the client. Please be aware that browsers cannot correctly display
      this error. Setting size to 0 disables checking of client request body size.
      This limits application uploads, buildpack uploads, etc.
    required: true
- name: NO_PROXY
  options:
    description: Comma separated list of IP addresses and domains which should not
      be directoed through a proxy, if any.
    required: false
- name: OPI_REGISTRY_NODEPORT
  options:
    type: environment
    description: "OPI registry port on the localhost nodePort"
- name: PERSI_NFS_ALLOWED_OPTIONS
  options:
    description: Comma separated list of white-listed options that may be set during
      create or bind operations.
    example: uid,gid,allow_root,allow_other,nfs_uid,nfs_gid,auto_cache,fsname,username,password
    default: uid,gid,auto_cache,username,password
- name: PERSI_NFS_BROKER_PASSWORD
  options:
    description: Basic auth password to verify on incoming Service Broker requests
    secret: true
    required: true
  type: password
- name: PERSI_NFS_DEFAULT_OPTIONS
  options:
    description: Comma separated list of default values for nfs mount options.  If
      a default is specified with an option not included in PERSI_NFS_ALLOWED_OPTIONS,  then
      this default value will be set and it won't be overridable.
- name: PERSI_NFS_DRIVER_ALLOWED_IN_MOUNT
  options:
    description: >
      Comma separated list of white-listed options that may be accepted
      in the mount_config options. Note a specific 'sloppy_mount:true' volume option
      tells the driver to ignore non-white-listed options, while a 'sloppy_mount:false'
      tells the driver to fail fast instead when receiving a non-white-listed option."
    example: allow_root,allow_other,nfs_uid,nfs_gid,auto_cache,sloppy_mount,fsname
    default: auto_cache
- name: PERSI_NFS_DRIVER_ALLOWED_IN_SOURCE
  options:
    description: Comma separated list of white-listed options that may be configured
      in supported in the  mount_config.source URL query params.
    example: uid,gid,auto-traverse-mounts,dircache
    default: uid,gid
- name: PERSI_NFS_DRIVER_DEFAULT_IN_MOUNT
  options:
    description: >
      Comma separated list default values for options that may be configured
      in the mount_config options, formatted as 'option:default'. If an option is
      not specified in the volume mount, or the option is not white-listed, then the
      specified default value will be used instead.
    example: allow_root:false,nfs_uid:2000,nfs_gid:2000,auto_cache:true,sloppy_mount:true
    default: auto_cache:true
- name: PERSI_NFS_DRIVER_DEFAULT_IN_SOURCE
  options:
    description: >
      Comma separated list of default values for options in the source
      URL query params, formatted as 'option:default'. If an option is not specified
      in the volume mount,  or the option is not white-listed, then the specified
      default value will be applied.
- name: PERSI_NFS_DRIVER_DISABLE
  options:
    description: Disable Persi NFS driver
    default: 'false'
- name: PERSI_NFS_DRIVER_LDAP_HOST
  options:
    description: LDAP server host name or ip address (required for LDAP integration
      only)
    default: ''
- name: PERSI_NFS_DRIVER_LDAP_PASSWORD
  options:
    description: LDAP service account password (required for LDAP integration only)
    default: "-"
    secret: true
- name: PERSI_NFS_DRIVER_LDAP_PORT
  options:
    description: LDAP server port (required for LDAP integration only)
    default: '389'
- name: PERSI_NFS_DRIVER_LDAP_PROTOCOL
  options:
    description: LDAP server protocol (required for LDAP integration only)
    default: tcp
- name: PERSI_NFS_DRIVER_LDAP_USER
  options:
    description: LDAP service account user name (required for LDAP integration only)
    default: ''
- name: PERSI_NFS_DRIVER_LDAP_USER_FQDN
  options:
    description: LDAP fqdn for user records we will search against when looking up
      user uids (required for LDAP integration only)
    example: cn=Users,dc=corp,dc=test,dc=com
    default: ''
- name: PROM_SCRAPER_METRICS_TLS_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: prom_scraper_metrics
    description: PEM-encoded prom_scraper certificate
    require: true
  type: certificate
- name: PROM_SCRAPER_METRICS_TLS_CERT_KEY
  options:
    secret: true
    description: PEM-encoded prom_scraper key
    require: true
- name: PROM_SCRAPER_SCRAPE_TLS_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded prom_scraper certificate
    require: true
  type: certificate
- name: PROM_SCRAPER_SCRAPE_TLS_CERT_KEY
  options:
    secret: true
    description: PEM-encoded prom_scraper key
    require: true
- name: PZ_LABEL_NAME
  options:
    default: ''
    description: The name of the metadata label to query on worker
      nodes to get placement tag information, also known as isolation
      segments. When set, the cells will query their worker node for
      placement information and inject the result into cloudfoundry
      via the KUBE_PZ parameter. When left to the default no custom
      placement processing is done.
    internal: true
- name: REP_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: diego-cell
    alternative_names:
    - 127.0.0.1
    description: PEM-encoded server certificate
    required: true
  type: certificate
- name: REP_SERVER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded server key
    required: true
- name: RLP_GATEWAY_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - log-stream
    - log-stream.((DOMAIN))
    - rlp-gateway
    - rlp-gateway.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    - log-api
    - log-api.((KUBERNETES_NAMESPACE)).svc.((KUBERNETES_CLUSTER_DOMAIN))
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: RLP_GATEWAY_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: ROOTFS_TRUSTED_CERTS
  options:
    default: ''
    description: Certficates to add to the rootfs trust store. Multiple certs are
      possible by concatenating their definitions into one big block of text.
- name: ROUTER_BALANCING_ALGORITHM
  options:
    default: round-robin
    description: The algorithm used by the router to distribute requests for a route
      across backends. Supported values are round-robin and least-connection.
- name: ROUTER_CLIENT_CERT_VALIDATION
  options:
    description: How to handle client certificates. Supported values are none, request,
      or require. See https://docs.cloudfoundry.org/adminguide/securing-traffic.html#gorouter_mutual_auth
      for more information.
    default: request
- name: ROUTER_FORWARDED_CLIENT_CERT
  options:
    default: always_forward
    description: How to handle the x-forwarded-client-cert (XFCC) HTTP header. Supported
      values are always_forward, forward, and sanitize_set. See https://docs.cloudfoundry.org/concepts/http-routing.html
      for more information.
- name: ROUTER_SERVICES_SECRET
  options:
    secret: true
    description: Support for route services is disabled when no value is configured.
      A robust passphrase is recommended.
    required: true
  type: password
- name: ROUTER_SSL_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - "*.{{.DOMAIN}}"
    description: The public ssl cert for ssl termination. Will be ignored if ROUTER_TLS_PEM
      is set.
    required: true
  type: certificate
- name: ROUTER_SSL_CERT_KEY
  options:
    secret: true
    description: The private ssl key for ssl termination. Will be ignored if ROUTER_TLS_PEM
      is set.
    required: true
- name: ROUTER_STATUS_PASSWORD
  options:
    secret: true
    description: Password for HTTP basic auth to the varz/status endpoint.
    required: true
  type: password
- name: ROUTER_TLS_PEM
  options:
    description: Array of private keys and certificates used for TLS handshakes with
      downstream clients. Each element in the array is an object containing fields
      'private_key' and 'cert_chain', each of which supports a PEM block. This setting
      overrides ROUTER_SSL_CERT and ROUTER_SSL_KEY.
    example: |
      - cert_chain: |
          -----BEGIN CERTIFICATE-----
          -----END CERTIFICATE-----
          -----BEGIN CERTIFICATE-----
          -----END CERTIFICATE-----
        private_key: |
          -----BEGIN RSA PRIVATE KEY-----
          -----END RSA PRIVATE KEY-----
    secret: true
- name: ROUTING_API_MTLS_CLIENT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: cf-usb
    description: PEM-encoded routing api mtls client certificate.
  type: certificate
- name: ROUTING_API_MTLS_CLIENT_CERT_KEY
  options:
    secret: true
    description: PEM-encoded routing api mtls client key.
- name: ROUTING_API_MTLS_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: cf-usb
    description: PEM-encoded routing api mtls server certificate.
  type: certificate
- name: ROUTING_API_MTLS_SERVER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded routing api mtls server key.
- name: SAML_SERVICEPROVIDER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate
  type: certificate
- name: SAML_SERVICEPROVIDER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
- name: SCF_LOG_HOST
  options:
    internal: true
    description: The log destination to talk to. This has to point to a syslog server.
- name: SCF_LOG_PORT
  options:
    internal: true
    description: The port used by rsyslog to talk to the log destination. It defaults
      to 514, the standard port of syslog.
    default: 514
- name: SCF_LOG_PROTOCOL
  options:
    internal: true
    default: tcp
    description: The protocol used by rsyslog to talk to the log destination. The
      allowed values are tcp, and udp. The default is tcp.
    required: true
- name: SMTP_AUTH
  options:
    default: false
    description: >
      If true, authenticate against the SMTP server using AUTH command.
      See https://javamail.java.net/nonav/docs/api/com/sun/mail/smtp/package-summary.html
- name: SMTP_FROM_ADDRESS
  options:
    description: SMTP from address, for password reset emails etc.
- name: SMTP_HOST
  options:
    description: SMTP server host address, for password reset emails etc.
- name: SMTP_PASSWORD
  options:
    description: SMTP server password, for password reset emails etc.
- name: SMTP_PORT
  options:
    default: 25
    description: SMTP server port, for password reset emails etc.
- name: SMTP_STARTTLS
  options:
    default: false
    description: >
      If true, send STARTTLS command before logging in to SMTP server.
      See https://javamail.java.net/nonav/docs/api/com/sun/mail/smtp/package-summary.html
- name: SMTP_USER
  options:
    description: SMTP server username, for password reset emails etc.
- name: STAGING_TIMEOUT
  options:
    default: 900
    description: Timeout for staging an app, in seconds.
    required: true
- name: STAGING_UPLOAD_PASSWORD
  options:
    secret: true
    description: The password for access to the uploader of staged droplets.
    required: true
  type: password
- name: SUPPORT_ADDRESS
  options:
    default: https://scc.suse.com
    description: Support contact information for the cluster
    required: true
- name: SYNC_INTEGRATION_TESTS_FLAKE_ATTEMPTS
  options:
    default: 3
    description: >
      The number of times Ginkgo will run a SITS test before treating it as a failure.
      Individual failed runs will still be reported in the test output.
- name: SYNC_INTEGRATION_TESTS_FOCUS
  options:
    description: >
      Regex for which SITS tests the test runner should focus on executing.
- name: SYNC_INTEGRATION_TESTS_NODES
  options:
    default: 4
    description: >
      The number of parallel test executors to spawn for Cloud Foundry
      sync integration tests.
- name: SYNC_INTEGRATION_TESTS_SKIP
  options:
    description: >
      Regex for which SITS tests the test runner should skip.
- name: SYNC_INTEGRATION_TESTS_VERBOSE
  options:
    default: false
    description: >
      Whether the output of the sync integration tests should be verbose or not.
- name: SYSLOG_ADAPT_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - adapter
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: SYSLOG_ADAPT_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: SYSLOG_RLP_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    alternative_names:
    - syslog_rlp
    - reverselogproxy
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: SYSLOG_RLP_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: SYSLOG_SCHED_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate
    required: true
  type: certificate
- name: SYSLOG_SCHED_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key.
    required: true
- name: TCP_DOMAIN
  options:
    example: tcp.my-scf-cluster.com
    required: true
    description: TCP routing domain of the SCF cluster; only used for testing;
- name: TPS_CC_CLIENT_CRT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded client certificate for internal communication between
      the cloud controller and TPS.
    required: true
  type: certificate
- name: TPS_CC_CLIENT_CRT_KEY
  options:
    secret: true
    description: PEM-encoded client key for internal communication between the cloud
      controller and TPS.
    required: true
- name: TRAFFICCONTROLLER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    description: PEM-encoded certificate for communication with the traffic controller
      of the log infra structure.
    required: true
  type: certificate
- name: TRAFFICCONTROLLER_CERT_KEY
  options:
    secret: true
    description: PEM-encoded key for communication with the traffic controller of
      the log infra structure.
    required: true
- name: TRUSTED_CERTS
  options:
    description: Concatenation of trusted CA certificates to be made available on
      the cell.
- name: UAADB_PASSWORD
  options:
    secret: true
    description: The password for access to the UAA database.
  type: password
- name: UAA_ADMIN_CLIENT_SECRET
  options:
    secret: true
    description: The password of the admin client - a client named admin with uaa.admin
      as an authority.
    required: true
- name: UAA_CA_CERT
  options:
    description: The CA certificate for UAA
    secret: true
- name: UAA_CLIENTS_CC_ROUTING_SECRET
  options:
    secret: true
    description: The password for UAA access by the Routing API.
    required: true
  type: password
- name: UAA_CLIENTS_CC_SERVICE_DASHBOARDS_CLIENT_SECRET
  options:
    secret: true
    description: Used for third party service dashboard SSO.
  type: password
- name: UAA_CLIENTS_CC_SERVICE_KEY_CLIENT_SECRET
  options:
    secret: true
    description: Used for fetching service key values from CredHub.
    required: true
  type: password
- name: UAA_CLIENTS_CF_SMOKE_TESTS_CLIENT_SECRET
  options:
    secret: true
    description: Client secret for the CF smoke tests job
    required: true
  type: password
- name: UAA_CLIENTS_CF_USB_SECRET
  options:
    secret: true
    description: The password for UAA access by the Universal Service Broker.
  type: password
- name: UAA_CLIENTS_CLOUD_CONTROLLER_USERNAME_LOOKUP_SECRET
  options:
    secret: true
    description: The password for UAA access by the Cloud Controller for fetching
      usernames.
    required: true
  type: password
- name: UAA_CLIENTS_CREDHUB_USER_CLI_SECRET
  options:
    secret: true
    description: The password for UAA access by the client for the user-accessible credhub
    required: true
  type: password
- name: UAA_CLIENTS_DIEGO_SSH_PROXY_SECRET
  options:
    secret: true
    description: The password for UAA access by the SSH proxy.
    required: true
  type: password
- name: UAA_CLIENTS_DOPPLER_SECRET
  options:
    secret: true
    description: The password for UAA access by doppler.
    required: true
  type: password
- name: UAA_CLIENTS_GOROUTER_SECRET
  options:
    secret: true
    description: The password for UAA access by the gorouter.
    required: true
  type: password
- name: UAA_CLIENTS_ROUTING_API_CLIENT_SECRET
  options:
    secret: true
    description: The OAuth client secret used by the routing-api.
    required: true
  type: password
- name: UAA_CLIENTS_SCF_AUTO_CONFIG_SECRET
  options:
    secret: true
    description: The password for UAA access by the task creating the cluster administrator
      user
    required: true
  type: password
- name: UAA_CLIENTS_TCP_EMITTER_SECRET
  options:
    secret: true
    description: The password for UAA access by the TCP emitter.
    required: true
  type: password
- name: UAA_CLIENTS_TCP_ROUTER_SECRET
  options:
    secret: true
    description: The password for UAA access by the TCP router.
    required: true
  type: password
- name: UAA_HOST
  options:
    description: The host name of the UAA server (root zone)
    required: true
- name: UAA_PORT
  options:
    default: 2793
    description: The tcp port the UAA server (root zone) listens on for requests.
- name: UAA_PUBLIC_PORT
  options:
    default: 2793
    description: The TCP port to report as the public port for the UAA server (root zone).
- name: UAA_SERVER_CERT
  options:
    secret: true
    ca: INTERNAL_CA_CERT
    role_name: uaa
    alternative_names:
    - uaa.{{.DOMAIN}}
    - "*.uaa.{{.DOMAIN}}"
    description: The server's ssl certificate. The default is a self-signed certificate
      and should always be replaced for production deployments.
  type: certificate
- name: UAA_SERVER_CERT_KEY
  options:
    secret: true
    description: The server's ssl private key. Only passphrase-less keys are supported.
- name: USE_DIEGO_PRIVILEGED_CONTAINERS
  options:
    default: false
    description: Whether or not to use privileged containers for buildpack based applications.
      Containers with a docker-image-based rootfs will continue to always be unprivileged.
    required: true
- name: USE_STAGER_PRIVILEGED_CONTAINERS
  options:
    default: false
    description: Whether or not to use privileged containers for staging tasks.
    required: true
