#!/bin/bash
set -e -x

DST=${BOSH_INSTALL_TARGET}

# Add repositories where to find fuse. Depending on the stemcell used
# these may already be known, or not.
zypper addrepo -n distro http://download.opensuse.org/distribution/leap/42.3/repo/oss/ distro
zypper addrepo -n update http://download.opensuse.org/update/leap/42.3/oss/            update

# Diagnostics
zypper --version
zypper repos -u
zypper --non-interactive --gpg-auto-import-keys refresh
zypper search -x -s --provides fuse

# Get and place fuse rpm archive
zypper --pkg-cache-dir $DST download fuse

# Show what we packaged.
echo ................................. packaged
find -L $DST -type f

exit
